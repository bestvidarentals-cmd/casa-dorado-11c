<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#fbf5ec" />
  <title>Casa Dorado 11C</title>

  <style>
    :root{
      --sand:#fbf5ec;
      --foam:#ffffff;
      --ink:#172126;
      --muted:#4b5c62;

      --teal:#18a7a5;
      --turq:#2cc7c2;
      --coral:#ff6f61;

      --stroke:rgba(23,33,38,.12);
      --shadow:0 10px 22px rgba(13, 32, 32, .12);
      --shadow-soft:0 6px 14px rgba(13, 32, 32, .10);

      --r-xl:22px;
      --r-lg:18px;
      --r-md:14px;

      --maxw:520px;
      --navh:64px;
      --tap:44px;
    }

    *{ box-sizing:border-box; }
    html, body{ height:100%; }
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      background: var(--sand);
      color: var(--ink);
    }

    /* Keep a subtle backdrop; hero provides the main visual now */
    .bg{
      position: fixed;
      inset: 0;
      z-index: 0;
      background: radial-gradient(1200px 800px at 40% 0%, rgba(44,199,194,.16), transparent 55%),
                  radial-gradient(900px 700px at 90% 30%, rgba(255,111,97,.12), transparent 55%),
                  linear-gradient(180deg, rgba(255,255,255,.0), rgba(255,255,255,.35));
    }

    .app{
      position:relative;
      z-index:1;
      max-width: var(--maxw);
      margin: 0 auto;
      padding: 12px 12px calc(var(--navh) + 16px);
    }

    .surface{
      background: rgba(255,255,255,.88);
      border: 1px solid var(--stroke);
      border-radius: 28px;
      box-shadow: var(--shadow);
      overflow:hidden;
      backdrop-filter: blur(6px);
    }

    header{
      position: sticky;
      top: 0;
      z-index: 5;
      background:
        linear-gradient(180deg, rgba(44,199,194,.14), rgba(255,255,255,0) 70%),
        rgba(255,255,255,.92);
      border-bottom: 1px solid var(--stroke);
      backdrop-filter: blur(10px);
    }
    .topbar{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap: 12px;
      padding: 14px 14px 10px;
    }
    .top-left{ min-width:0; }
    .title{
      margin:0;
      font-size: 18px;
      font-weight: 900;
      letter-spacing:.2px;
      line-height:1.15;
    }
    .subtitle{
      margin:6px 0 0;
      font-size: 13px;
      line-height:1.35;
      color: var(--muted);
    }

    .top-actions{
      display:flex;
      gap:8px;
      align-items:center;
      flex:0 0 auto;
    }

    button{ font: inherit; }
    .chip{
      height: 38px;
      border-radius: 999px;
      padding: 0 12px;
      border:1px solid var(--stroke);
      background: var(--foam);
      color: var(--ink);
      font-weight: 850;
      font-size: 12.5px;
      cursor:pointer;
      box-shadow: var(--shadow-soft);
      -webkit-tap-highlight-color: transparent;
      user-select:none;
      white-space:nowrap;
    }
    .chip:active{ transform: scale(.99); }
    .chip:focus-visible{
      outline: 3px solid rgba(24,167,165,.35);
      outline-offset: 2px;
    }
    .chip.primary{
      border-color: rgba(24,167,165,.35);
      background: rgba(44,199,194,.14);
    }
    .chip.coral{
      border-color: rgba(255,111,97,.45);
      background: rgba(255,111,97,.14);
    }

    main{ padding: 14px; }

    .card{
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.92);
      border-radius: var(--r-xl);
      padding: 14px;
      box-shadow: var(--shadow-soft);
    }
    .stack{ display:flex; flex-direction:column; gap: 12px; }
    .h2{
      margin:0 0 8px;
      font-size: 16px;
      font-weight: 900;
      letter-spacing:.2px;
    }
    .meta{
      margin:0 0 10px;
      color: var(--muted);
      font-size: 13px;
      line-height:1.45;
    }

    .kv{
      display:flex;
      justify-content:space-between;
      align-items:flex-start;
      gap: 10px;
      padding: 10px 12px;
      border-radius: var(--r-lg);
      border: 1px solid rgba(24,167,165,.18);
      background: linear-gradient(180deg, rgba(44,199,194,.10), rgba(255,255,255,0));
      font-size: 13.5px;
    }
    .kv.coral{
      border: 1px solid rgba(255,111,97,.22);
      background: linear-gradient(180deg, rgba(255,111,97,.12), rgba(255,255,255,0));
    }
    .k{
      color: rgba(23,33,38,.72);
      font-weight: 900;
      min-width: 92px;
      flex:0 0 auto;
    }
    .v{
      text-align:right;
      font-weight: 650;
      flex: 1 1 auto;
    }
    .v.left{ text-align:left; }
    .mono{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      letter-spacing:.2px;
    }

    /* Hero */
    .hero{
      border: 1px solid var(--stroke);
      border-radius: 26px;
      overflow:hidden;
      box-shadow: var(--shadow-soft);
      background: #fff;
    }
    .heroMedia{
      position:relative;
      height: 190px;
      background: #ddd;
    }
    .heroMedia img{
      width:100%;
      height:100%;
      object-fit: cover;
      display:block;
    }
    .heroOverlay{
      position:absolute;
      inset:0;
      background: linear-gradient(180deg, rgba(0,0,0,.30), rgba(0,0,0,.05) 55%, rgba(255,255,255,0));
    }
    .heroText{
      position:absolute;
      left: 12px;
      right: 12px;
      bottom: 12px;
      color:#fff;
      text-shadow: 0 2px 14px rgba(0,0,0,.35);
    }
    .heroText h2{
      margin:0;
      font-size: 18px;
      font-weight: 950;
      letter-spacing:.2px;
      line-height:1.15;
    }
    .heroText p{
      margin:6px 0 0;
      font-size: 13px;
      line-height:1.25;
      opacity:.95;
    }

    /* Tiles */
    .tiles{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-top: 12px;
    }
    .tile{
      min-height: 90px;
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap: 10px;
      padding: 12px;
      border-radius: 22px;
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.92);
      box-shadow: var(--shadow-soft);
      -webkit-tap-highlight-color: transparent;
      cursor:pointer;
      text-align:left;
    }
    .tile:active{ transform: scale(.99); }
    .tileLeft strong{
      display:block;
      font-size: 14px;
      font-weight: 950;
      line-height:1.1;
      letter-spacing:.2px;
    }
    .tileLeft span{
      display:block;
      margin-top: 4px;
      font-size: 12.5px;
      color: var(--muted);
      line-height:1.2;
    }
    .tileIco{
      width: 42px;
      height: 42px;
      border-radius: 16px;
      display:grid;
      place-items:center;
      background: rgba(44,199,194,.14);
      border: 1px solid rgba(24,167,165,.22);
      flex: 0 0 auto;
      font-size: 18px;
    }
    .tileIco.coral{
      background: rgba(255,111,97,.14);
      border: 1px solid rgba(255,111,97,.22);
    }

    .linkGrid{ display:flex; flex-direction:column; gap: 10px; }
    .linkCard{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
      padding: 14px;
      border-radius: var(--r-xl);
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.92);
      text-decoration:none;
      color: var(--ink);
      box-shadow: var(--shadow-soft);
      -webkit-tap-highlight-color: transparent;
      scroll-margin-top: 86px;
    }
    .linkCard:active{ transform: scale(.99); }
    .linkLeft{ min-width:0; }
    .linkTitle{
      font-weight: 900;
      font-size: 14px;
      letter-spacing:.2px;
      line-height: 1.15;
    }
    .linkSub{
      margin-top: 4px;
      font-size: 12.5px;
      color: var(--muted);
      line-height:1.25;
    }
    .linkPill{
      padding: 10px 12px;
      border-radius: 999px;
      font-weight: 900;
      font-size: 12px;
      border: 1px solid rgba(24,167,165,.35);
      background: rgba(44,199,194,.16);
      flex: 0 0 auto;
      white-space:nowrap;
    }
    .linkPill.coral{
      border: 1px solid rgba(255,111,97,.40);
      background: rgba(255,111,97,.16);
    }

    details{
      border: 1px solid var(--stroke);
      border-radius: var(--r-xl);
      background: rgba(255,255,255,.92);
      box-shadow: var(--shadow-soft);
      overflow:hidden;
    }
    summary{
      list-style:none;
      cursor:pointer;
      padding: 14px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      min-height: var(--tap);
      -webkit-tap-highlight-color: transparent;
      font-weight: 900;
      font-size: 14px;
    }
    summary::-webkit-details-marker{ display:none; }
    .chev{
      width: 28px; height: 28px;
      border-radius: 12px;
      display:grid;
      place-items:center;
      border: 1px solid var(--stroke);
      background: rgba(44,199,194,.10);
      flex: 0 0 auto;
      transition: transform .18s ease;
    }
    details[open] .chev{ transform: rotate(180deg); }
    .detailsBody{
      padding: 0 14px 14px;
      color: var(--ink);
      font-size: 13.5px;
      line-height:1.5;
    }
    ul.clean{ margin: 8px 0 0; padding-left: 18px; }
    ul.clean li{ margin: 6px 0; }

    .qrWrap{
      display:flex;
      flex-direction:column;
      align-items:center;
      gap: 8px;
      margin-top: 12px;
    }
    .qr{
      width: 180px;
      max-width: 100%;
      border-radius: var(--r-xl);
      box-shadow: var(--shadow-soft);
      border: 1px solid var(--stroke);
    }

    .bottomNav{
      position: fixed;
      left: 0;
      right: 0;
      bottom: 0;
      z-index: 10;
      display:flex;
      justify-content:center;
      padding: 10px 12px 12px;
      pointer-events:none;
    }
    .navBar{
      pointer-events:auto;
      width: min(var(--maxw), calc(100% - 24px));
      background: rgba(255,255,255,.92);
      border: 1px solid var(--stroke);
      box-shadow: var(--shadow);
      border-radius: 22px;
      display:grid;
      grid-template-columns: repeat(5, 1fr);
      min-height: var(--navh);
      backdrop-filter: blur(10px);
      overflow:hidden;
    }
    .navBtn{
      border:0;
      background: transparent;
      padding: 8px 6px;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      gap: 4px;
      cursor:pointer;
      -webkit-tap-highlight-color: transparent;
      color: rgba(23,33,38,.70);
      font-weight: 850;
      font-size: 11px;
      min-height: var(--navh);
    }
    .navBtn .ico{ font-size: 18px; line-height:1; }
    .navBtn[aria-current="page"]{
      color: var(--ink);
      background: linear-gradient(180deg, rgba(44,199,194,.18), rgba(255,255,255,0));
    }
    .navBtn:focus-visible{
      outline: 3px solid rgba(24,167,165,.35);
      outline-offset: -3px;
    }

    .backdrop{
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,.40);
      z-index: 20;
      display:none;
      align-items:flex-end;
      justify-content:center;
      padding: 12px;
    }
    .backdrop.open{ display:flex; }
    .sheet{
      width: min(var(--maxw), 100%);
      background: rgba(255,255,255,.96);
      border: 1px solid var(--stroke);
      border-radius: 24px;
      box-shadow: var(--shadow);
      overflow:hidden;
      max-height: min(80dvh, 560px);
      display:flex;
      flex-direction:column;
    }
    .sheetHead{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      padding: 12px 14px;
      border-bottom: 1px solid var(--stroke);
      background: linear-gradient(180deg, rgba(44,199,194,.12), rgba(255,255,255,0) 70%);
    }
    .sheetTitle{
      margin:0;
      font-size: 14px;
      font-weight: 900;
      letter-spacing:.2px;
    }
    .sheetBody{
      padding: 12px 14px 14px;
      overflow:auto;
      -webkit-overflow-scrolling: touch;
    }
    .field{
      display:flex;
      gap: 10px;
      align-items:center;
      border: 1px solid var(--stroke);
      background: #fff;
      border-radius: 16px;
      padding: 10px 12px;
      box-shadow: var(--shadow-soft);
    }
    .field input{
      border:0;
      outline:0;
      width:100%;
      font-size: 14px;
      background: transparent;
    }
    .hint{
      margin: 10px 0 0;
      font-size: 12.5px;
      color: var(--muted);
      line-height:1.35;
    }
    .list{
      margin-top: 12px;
      display:flex;
      flex-direction:column;
      gap: 10px;
    }
    .miniBtn{
      width:100%;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap: 12px;
      padding: 12px 14px;
      border-radius: 18px;
      border: 1px solid var(--stroke);
      background: rgba(255,255,255,.92);
      box-shadow: var(--shadow-soft);
      cursor:pointer;
      text-align:left;
      -webkit-tap-highlight-color: transparent;
      font-weight: 900;
      color: var(--ink);
    }
    .miniBtn span{
      display:block;
      font-weight: 700;
      color: var(--muted);
      font-size: 12.5px;
      margin-top: 2px;
    }
    .rightMark{
      flex: 0 0 auto;
      padding: 8px 10px;
      border-radius: 999px;
      border: 1px solid rgba(24,167,165,.35);
      background: rgba(44,199,194,.14);
      font-size: 12px;
      font-weight: 900;
      color: var(--ink);
      white-space:nowrap;
    }

    .toast{
      position: fixed;
      left: 50%;
      transform: translateX(-50%);
      bottom: calc(var(--navh) + 18px);
      z-index: 30;
      background: rgba(23,33,38,.92);
      color: #fff;
      padding: 10px 12px;
      border-radius: 14px;
      font-size: 13px;
      display:none;
      box-shadow: var(--shadow);
      max-width: calc(100% - 24px);
      text-align:center;
    }
    .toast.show{ display:block; }

    @media (max-width: 360px){
      .tiles{ grid-template-columns: 1fr; }
    }
  </style>
</head>

<body>
  <div class="bg" aria-hidden="true"></div>

  <div class="app">
    <div class="surface" role="application" aria-label="Guest info hub">
      <header>
        <div class="topbar">
          <div class="top-left">
            <h1 class="title" id="propTitle"></h1>
            <p class="subtitle" id="propSubtitle"></p>
          </div>
          <div class="top-actions">
            <button class="chip primary" id="unitToggle" type="button" aria-label="Unit toggle"></button>
            <button class="chip" id="langToggle" type="button" aria-label="Language toggle"></button>
            <button class="chip coral" id="openSearch" type="button" aria-label="Search">üîé</button>
          </div>
        </div>
      </header>

      <main>
        <div id="page" class="stack"></div>
      </main>
    </div>
  </div>

  <div class="bottomNav" aria-hidden="false">
    <div class="navBar" role="navigation" aria-label="Primary">
      <button class="navBtn" data-page="home" aria-current="page" type="button"><div class="ico">üèùÔ∏è</div>Home</button>
      <button class="navBtn" data-page="arrival" type="button"><div class="ico">üß≥</div>Arrival</button>
      <button class="navBtn" data-page="condo" type="button"><div class="ico">üè†</div>Condo</button>
      <button class="navBtn" data-page="local" type="button"><div class="ico">üìç</div>Local</button>
      <button class="navBtn" id="openMore" type="button"><div class="ico">‚ûï</div>More</button>
    </div>
  </div>

  <div class="backdrop" id="searchBackdrop" role="dialog" aria-modal="true" aria-label="Search">
    <div class="sheet" role="document">
      <div class="sheetHead">
        <p class="sheetTitle" id="searchTitle">Search</p>
        <button class="chip" id="closeSearch" type="button">‚úï</button>
      </div>
      <div class="sheetBody">
        <div class="field">
          <span aria-hidden="true">üîé</span>
          <input id="searchInput" type="search" placeholder="Search: Wi-Fi, gate, trash, safe, checkout‚Ä¶" autocomplete="off" />
        </div>
        <p class="hint" id="searchHint"></p>
        <div class="list" id="searchResults"></div>
      </div>
    </div>
  </div>

  <div class="backdrop" id="moreBackdrop" role="dialog" aria-modal="true" aria-label="More menu">
    <div class="sheet" role="document">
      <div class="sheetHead">
        <p class="sheetTitle" id="moreTitle">More</p>
        <button class="chip" id="closeMore" type="button">‚úï</button>
      </div>
      <div class="sheetBody">
        <div class="list" id="moreList"></div>
      </div>
    </div>
  </div>

  <div class="toast" id="toast" role="status" aria-live="polite"></div>

  <script>
    /**********************************************************
     * CONTENT
     **********************************************************/
    const CONTENT = {
      propertyName: "Casa Dorado 11C",

      wifi: { name: "DoradoGuest", pass: "b13nv3n1d0" },

      directions: {
        addressLine1: "CDA Las Nubes MZ19 LT01 Edificio 11 Apt C",
        city: "Puerto Morelos",
        state: "Quintana Roo",
        zip: "77580",
        mapLink: "https://maps.app.goo.gl/Ufmdhn7Jatqre1Es5"
      },

      links: {
        localbird: "https://localbird.io/"
      },

      arrival: {
        checkinTime: "3:00 PM",
        checkoutTime: "11:00 AM",
        notesEN: [
          "Your personal door code will be sent privately before arrival.",
          "Check-in is after 3:00 PM.",
          "If you arrive early, check with the property manager to see if you can drop luggage in the unit."
        ],
        notesES: [
          "Tu c√≥digo personal se enviar√° por privado antes de tu llegada.",
          "La llegada es despu√©s de las 3:00 PM.",
          "Si llegas temprano, consulta con el administrador para ver si puedes dejar maletas en la unidad."
        ],
        checkoutEN: [
          "Turn off A/C + lights",
          "Leave used towels in the bathroom",
          "Check for personal items",
          "Lock the door behind you"
        ],
        checkoutES: [
          "Apaga A/C y luces",
          "Deja toallas usadas en el ba√±o",
          "Revisa que no olvides pertenencias",
          "Cierra con llave al salir"
        ]
      },

      houseGuideVideos: [
        { id:"door", icon:"üîí", titleEN:"Door Lock",       titleES:"Cerradura de la puerta",     link:"https://youtu.be/dZfc3S7i0bk" },
        { icon:"üö™", titleEN:"Open Patio Gate", titleES:"Abrir la puerta del patio",  link:"https://youtu.be/s7U20fFmzC0" },
        { icon:"üí°", titleEN:"Smart Lighting",  titleES:"Luces inteligentes",         link:"https://youtu.be/QDtUwEeHmGc" },
        { icon:"üì∫", titleEN:"Watch IPTV",      titleES:"Ver IPTV",                   link:"https://youtu.be/w78NTtRqdbI" },
        { icon:"‚ùÑÔ∏è", titleEN:"A/C Remote",      titleES:"Control del A/C",            link:"https://youtu.be/UFgrTn4xALA" },
        { icon:"üíß", titleEN:"Bottled Water",   titleES:"Agua embotellada",           link:"https://youtu.be/nwUs4Plp5dc" },

        { id:"trash", icon:"üöÆ", titleEN:"Trash", titleES:"Basura", link:"https://youtu.be/jsMapNBDmdw",
          subEN:"üîí Padlock combo: 3648", subES:"üîí Combinaci√≥n del candado: 3648" },

        { id:"safe", icon:"üîê", titleEN:"Wall Safe", titleES:"Caja fuerte", link:"https://youtu.be/DzP-1L-ezx8" }
      ],

      rules: {
        parkingEN: [
          "Park only in the assigned spot for your apartment."
        ],
        parkingES: [
          "Estaciona solo en el lugar asignado a tu departamento."
        ],
        homeEN: ["No smoking inside","No pets"],
        homeES: ["No fumar dentro","No mascotas"],
        poolEN: [
          "Pool hours: 8:00 AM ‚Äì 10:00 PM",
          "Shower before entering the pool",
          "You must have the FOB to access the pool"
        ],
        poolES: [
          "Horario de piscina: 8:00 AM ‚Äì 10:00 PM",
          "D√∫chate antes de entrar a la piscina",
          "Necesitas el FOB para acceso a la alberca"
        ],
        quietEN: ["Quiet hours: 10:00 PM ‚Äì 8:00 AM"],
        quietES: ["Horario de silencio: 10:00 PM ‚Äì 8:00 AM"]
      },

      shopping: {
        supermarkets: [
          { name: "S√∫per Ak√≠", link: "https://maps.app.goo.gl/mtMzpqGACHH7ACL16" },
          { name: "Chedraui", link: "https://maps.app.goo.gl/FRy6cjrsPJuGBxPx8" },
          { name: "Chedraui Selecto (nearby)", link: "https://www.google.com/maps/search/?api=1&query=Chedraui+Selecto+Puerto+Morelos+Quintana+Roo" }
        ],
        localGroceries: [
          { name: "OXXO (nearby)", link: "https://www.google.com/maps/search/?api=1&query=OXXO+Puerto+Morelos+Quintana+Roo" }
        ],
        fruitStands: [
          { name: "Fruit stand (Colonia side) #1", link: "https://www.google.com/maps/search/?api=1&query=fruteria+Colonia+Puerto+Morelos+Quintana+Roo" },
          { name: "Fruit stand (Colonia side) #2", link: "https://www.google.com/maps/search/?api=1&query=puesto+de+frutas+Colonia+Puerto+Morelos+Quintana+Roo" }
        ]
      },

      restaurants: {
        breakfast: [
          { name:"La Bodega Verde", link:"https://maps.app.goo.gl/JZapobhJJ3iQNjoH6" },
          { name:"El Nicho", link:"https://maps.app.goo.gl/qZNhAK6RA7MYN9Dg8" },
          { name:"Lola y Moya", link:"https://www.google.com/maps/search/?api=1&query=Lola+y+Moya+Puerto+Morelos" },
          { name:"Mangata", link:"https://www.google.com/maps/search/?api=1&query=Mangata+Puerto+Morelos" }
        ],
        seafood: [
          { name:"Los Koras", link:"https://www.google.com/maps/search/?api=1&query=Los+Koras+Puerto+Morelos" },
          { name:"La Playita", link:"https://www.google.com/maps/search/?api=1&query=La+Playita+Puerto+Morelos" },
          { name:"El Picudo", link:"https://www.google.com/maps/search/?api=1&query=El Picudo Puerto Morelos" }
        ],
        dinner: [
          { name:"Punta Corcho", link:"https://www.google.com/maps/search/?api=1&query=Punta+Corcho+Puerto+Morelos" },
          { name:"La Sirena", link:"https://www.google.com/maps/search/?api=1&query=La+Sirena+Puerto+Morelos" },
          { name:"Miles Kitchen", link:"https://www.google.com/maps/search/?api=1&query=Miles+Kitchen+Puerto+Morelos" }
        ],
        pizza: [
          { name:"I Wanna Pizza", link:"https://www.google.com/maps/search/?api=1&query=I+Wanna+Pizza+Puerto+Morelos" },
          { name:"La Pizza Nostra", link:"https://www.google.com/maps/search/?api=1&query=La+Pizza+Nostra+Puerto+Morelos" },
          { name:"Oma Wood Oven Pizza", link:"https://www.google.com/maps/search/?api=1&query=Oma+Wood+Oven+Pizza+Puerto+Morelos" }
        ]
      },

      sos: {
        propertyManagers: [
          { name: "Gerardo Garcia", whatsappE164: "525587197202" },
          { name: "Abby Garcia", whatsappE164: "525529811958" }
        ],
        owner: { name: "Tony", whatsappE164: "13039751749" }
      },

      contacts: {
        gate: { whatsappE164: "5219983956124" },
        rentals: {
          car: { name: "Luis", whatsappE164: "51992149573" },
          bike: { name: "Priscilla", whatsappE164: "5219982315086" }
        }
      }
    };

    const UNITS = {
      "11c": { label: "11C", propertyName: "Casa Dorado 11C", safeVideo: "https://youtu.be/DzP-1L-ezx8" },
      "11d": { label: "11D", propertyName: "Casa Dorado 11D", safeVideo: "https://youtu.be/CS53-VqRZlE" }
    };

    let unitKey = "11c";

    function applyUnit(newKey){
      unitKey = (newKey === "11d") ? "11d" : "11c";
      const u = UNITS[unitKey];

      CONTENT.propertyName = u.propertyName;
      document.title = u.propertyName;

      const safeItem = (CONTENT.houseGuideVideos || []).find(v => v.id === "safe");
      if(safeItem) safeItem.link = u.safeVideo;

      const unitToggle = document.getElementById("unitToggle");
      if(unitToggle) unitToggle.textContent = (lang==="en" ? `Unit ${u.label}` : `Unidad ${u.label}`);

      const url = new URL(window.location.href);
      url.searchParams.set("unit", unitKey);
      window.history.replaceState({}, "", url.toString());
    }

    function initUnitFromUrl(){
      try{
        const url = new URL(window.location.href);
        const u = (url.searchParams.get("unit") || "").toLowerCase();
        if(u === "11d" || u === "d") return "11d";
      }catch(e){}
      return "11c";
    }

    /**********************************************************
     * APP
     **********************************************************/
    const I18N = {
      en: {
        subtitle: "Everything you need for a smooth stay‚Äîfast, simple, mobile-friendly.",
        searchTitle: "Search",
        searchHint: "Try: Wi-Fi, gate, trash, safe, checkout‚Ä¶",
        moreTitle: "More",
        nav: { home:"Home", arrival:"Arrival", condo:"Condo", local:"Local", more:"More" },
        buttons: { copy: "Copy", copied: "Copied ‚úÖ", watch: "Watch", map: "Map" },
        labels: { address: "Address", checkin: "Check-in", checkout: "Check-out", wifiNetwork: "Network", wifiPassword: "Password" },
        sections: {
          parking: "Parking", home: "Home", pool: "Pool", quiet: "Quiet Hours",
          supermarkets: "Supermarkets", local: "Local Grocery", fruit: "Fruit Stands",
          breakfast: "Breakfast / Coffee", seafood: "Seafood", dinner: "Dinner", pizza: "Pizza"
        }
      },
      es: {
        subtitle: "Todo lo esencial para tu estancia‚Äîr√°pido, simple y f√°cil en el celular.",
        searchTitle: "Buscar",
        searchHint: "Ejemplos: Wi-Fi, caseta, basura, caja fuerte, salida‚Ä¶",
        moreTitle: "M√°s",
        nav: { home:"Inicio", arrival:"Llegada", condo:"Condo", local:"Local", more:"M√°s" },
        buttons: { copy: "Copiar", copied: "Copiado ‚úÖ", watch: "Ver", map: "Mapa" },
        labels: { address: "Direcci√≥n", checkin: "Llegada", checkout: "Salida", wifiNetwork: "Red", wifiPassword: "Contrase√±a" },
        sections: {
          parking: "Estacionamiento", home: "Casa", pool: "Piscina", quiet: "Silencio",
          supermarkets: "Supermercados", local: "Tienda / OXXO", fruit: "Frutas (Colonia)",
          breakfast: "Desayuno / Caf√©", seafood: "Mariscos", dinner: "Cena", pizza: "Pizza"
        }
      }
    };

    let lang = "en";
    let currentPage = "home";

    const pageEl = document.getElementById("page");
    const propTitle = document.getElementById("propTitle");
    const propSubtitle = document.getElementById("propSubtitle");
    const langToggle = document.getElementById("langToggle");
    const unitToggle = document.getElementById("unitToggle");
    const toastEl = document.getElementById("toast");

    const navBtns = [...document.querySelectorAll(".navBtn[data-page]")];
    const openMoreBtn = document.getElementById("openMore");

    const searchBackdrop = document.getElementById("searchBackdrop");
    const moreBackdrop = document.getElementById("moreBackdrop");
    const openSearchBtn = document.getElementById("openSearch");
    const closeSearchBtn = document.getElementById("closeSearch");
    const closeMoreBtn = document.getElementById("closeMore");
    const searchInput = document.getElementById("searchInput");
    const searchResults = document.getElementById("searchResults");
    const searchTitle = document.getElementById("searchTitle");
    const searchHint = document.getElementById("searchHint");
    const moreTitle = document.getElementById("moreTitle");
    const moreList = document.getElementById("moreList");

    function toast(msg){
      toastEl.textContent = msg;
      toastEl.classList.add("show");
      clearTimeout(toast._t);
      toast._t = setTimeout(()=> toastEl.classList.remove("show"), 1600);
    }

    function setChrome(){
      propTitle.textContent = CONTENT.propertyName;
      document.title = CONTENT.propertyName;
      propSubtitle.textContent = I18N[lang].subtitle;
      langToggle.textContent = (lang === "en") ? "ES" : "EN";
      document.documentElement.lang = lang;

      const u = UNITS[unitKey];
      unitToggle.textContent = (lang==="en" ? `Unit ${u.label}` : `Unidad ${u.label}`);

      const labels = I18N[lang].nav;
      const homeBtn = document.querySelector('.navBtn[data-page="home"]');
      const arrBtn  = document.querySelector('.navBtn[data-page="arrival"]');
      const conBtn  = document.querySelector('.navBtn[data-page="condo"]');
      const locBtn  = document.querySelector('.navBtn[data-page="local"]');
      if(homeBtn) homeBtn.lastChild.nodeValue = labels.home;
      if(arrBtn)  arrBtn.lastChild.nodeValue  = labels.arrival;
      if(conBtn)  conBtn.lastChild.nodeValue  = labels.condo;
      if(locBtn)  locBtn.lastChild.nodeValue  = labels.local;
      if(openMoreBtn) openMoreBtn.lastChild.nodeValue = labels.more;

      searchTitle.textContent = I18N[lang].searchTitle;
      searchHint.textContent  = I18N[lang].searchHint;
      moreTitle.textContent   = I18N[lang].moreTitle;

      buildMoreList();
    }

    function makeAddress(){
      const d = CONTENT.directions;
      return `${d.addressLine1}, ${d.city}, ${d.state} ${d.zip}`;
    }

    function kv(theme, k, v, left=false){
      return `
        <div class="kv ${theme==='coral'?'coral':''}">
          <div class="k">${k}</div>
          <div class="v ${left?'left':''}">${v}</div>
        </div>
      `;
    }

    function bullets(list){
      return `<ul class="clean">${(list||[]).map(x=>`<li>${x}</li>`).join("")}</ul>`;
    }

    function linkCard(title, link, pillText, coral=false, subText="", id=""){
      const safeId = (id || "").replace(/[^a-zA-Z0-9_-]/g, "");
      return `
        <a class="linkCard" ${safeId ? `id="${safeId}"` : ""} href="${link}" target="_blank" rel="noopener">
          <div class="linkLeft">
            <div class="linkTitle">${title}</div>
            ${subText ? `<div class="linkSub">${subText}</div>` : ""}
          </div>
          <div class="linkPill ${coral?'coral':''}">${pillText} ‚Üó</div>
        </a>
      `;
    }

    async function copyText(text){
      try{
        await navigator.clipboard.writeText(text);
        return true;
      }catch{
        try{
          const ta = document.createElement("textarea");
          ta.value = text;
          ta.setAttribute("readonly","");
          ta.style.position = "fixed";
          ta.style.left = "-9999px";
          document.body.appendChild(ta);
          ta.select();
          const ok = document.execCommand("copy");
          document.body.removeChild(ta);
          return ok;
        }catch{
          return false;
        }
      }
    }

    function setActiveNav(page){
      navBtns.forEach(b=>{
        const is = b.dataset.page === page;
        b.setAttribute("aria-current", is ? "page" : "false");
      });
    }

    function scrollToFocusIfNeeded(){
      if(!window.__focusId) return;
      const id = String(window.__focusId || "").replace(/[^a-zA-Z0-9_-]/g, "");
      const el = document.getElementById(id);
      if(el){
        el.scrollIntoView({behavior:"smooth", block:"start"});
      }
      window.__focusId = null;
    }

    function openSheet(el){
      el.classList.add("open");
      if(el === searchBackdrop){
        setTimeout(()=> searchInput.focus(), 50);
      }
    }
    function closeSheet(el){ el.classList.remove("open"); }

    function initAccordion(root){
      if (!root) return;

      const details = [...root.querySelectorAll("details")];
      details.forEach(d => d.open = false);

      root.addEventListener("toggle", (e) => {
        const opened = e.target;
        if (!(opened instanceof HTMLDetailsElement)) return;
        if (!opened.open) return;

        const localGroup =
          opened.closest(".detailsBody")?.querySelectorAll(":scope > details") ||
          root.querySelectorAll("details");

        [...localGroup].forEach(d => {
          if (d !== opened) d.open = false;
        });
      }, true);
    }

    function render(page){
      currentPage = page;
      setActiveNav(page);

      if(page === "home"){
        const addr = makeAddress();
        pageEl.innerHTML = `
          <section class="card">
            <div class="hero">
              <div class="heroMedia">
                <img src="hero.webp" alt="${lang==="en"?"Pool and tropical garden":"Piscina y jard√≠n tropical"}" loading="eager" decoding="async" />
                <div class="heroOverlay" aria-hidden="true"></div>
                <div class="heroText">
                  <h2>${lang==="en"?"Welcome":"Bienvenidos"}</h2>
                  <p>${lang==="en"?"Everything you need‚Äîright here on your phone.":"Todo lo que necesitas‚Äîen tu celular."}</p>
                </div>
              </div>
            </div>

            <div class="stack" style="margin-top:12px;">
              ${kv("teal", I18N[lang].labels.checkin, CONTENT.arrival.checkinTime)}
              ${kv("coral", I18N[lang].labels.checkout, CONTENT.arrival.checkoutTime)}
              <div class="kv">
                <div class="k">${I18N[lang].labels.address}</div>
                <div class="v left">${addr}</div>
              </div>
            </div>

            <div class="tiles" role="list" aria-label="${lang==="en"?"Quick tiles":"Accesos r√°pidos"}">
              <button class="tile" type="button" role="listitem" data-jump="arrival">
                <div class="tileLeft">
                  <strong>üß≥ ${lang==="en"?"Arrival":"Llegada"}</strong>
                  <span>${lang==="en"?"Gate + check-in + airport transport":"Caseta + entrada + transporte"}</span>
                </div>
                <div class="tileIco">‚Üí</div>
              </button>

              <button class="tile" type="button" role="listitem" data-jump="condo" data-focus="wifi">
                <div class="tileLeft">
                  <strong>üì∂ Wi-Fi</strong>
                  <span>${lang==="en"?"Network + QR":"Red + QR"}</span>
                </div>
                <div class="tileIco">üì∂</div>
              </button>

              <button class="tile" type="button" role="listitem" data-jump="condo" data-focus="videos">
                <div class="tileLeft">
                  <strong>üé¨ ${lang==="en"?"Videos":"Videos"}</strong>
                  <span>${lang==="en"?"Door, A/C, safe, trash‚Ä¶":"Puerta, A/C, caja fuerte‚Ä¶"}</span>
                </div>
                <div class="tileIco">üé•</div>
              </button>

              <button class="tile" type="button" role="listitem" data-jump="local">
                <div class="tileLeft">
                  <strong>üìç ${lang==="en"?"Local guide":"Gu√≠a local"}</strong>
                  <span>${lang==="en"?"Food, shopping, rentals":"Comida, compras, rentas"}</span>
                </div>
                <div class="tileIco">üó∫Ô∏è</div>
              </button>

              <button class="tile" type="button" role="listitem" data-jump="local" data-focus="checkout">
                <div class="tileLeft">
                  <strong>‚úÖ ${lang==="en"?"Departure":"Salida"}</strong>
                  <span>${lang==="en"?"Check-out checklist":"Checklist de salida"}</span>
                </div>
                <div class="tileIco coral">‚è±Ô∏è</div>
              </button>

              <button class="tile" type="button" role="listitem" data-jump="condo" data-focus="sos">
                <div class="tileLeft">
                  <strong>üÜò ${lang==="en"?"Help":"Ayuda"}</strong>
                  <span>${lang==="en"?"WhatsApp managers":"WhatsApp administradores"}</span>
                </div>
                <div class="tileIco coral">üí¨</div>
              </button>
            </div>
          </section>
        `;

        pageEl.querySelectorAll("[data-jump]").forEach(el=>{
          el.addEventListener("click", ()=>{
            const target = el.getAttribute("data-jump");
            if(target) go(target, el.getAttribute("data-focus"));
          });
        });

        initAccordion(pageEl);
        return;
      }

      /* ----- Arrival / Condo / Local blocks are EXACTLY the ones you requested ----- */
      if(page === "arrival"){
        const notes = (lang==="en") ? CONTENT.arrival.notesEN : CONTENT.arrival.notesES;

        pageEl.innerHTML = `
          <section class="card">
            <h2 class="h2">üß≥ ${lang==="en"?"Arrival":"Llegada"}</h2>
            <p class="meta">${lang==="en"
              ? "Quick essentials for getting in smoothly."
              : "Lo esencial para entrar sin complicaciones."
            }</p>

            <div class="stack">
              ${kv("teal", I18N[lang].labels.checkin, CONTENT.arrival.checkinTime)}
              ${kv("coral", I18N[lang].labels.checkout, CONTENT.arrival.checkoutTime)}
            </div>

            <div class="stack" style="margin-top:12px;">
              <details id="gate">
                <summary>${lang==="en"?"Main gate instructions":"Instrucciones para la caseta"} <span class="chev">‚åÑ</span></summary>
                <div class="detailsBody">
                  <div class="kv">
                    <div class="k">${lang==="en"?"At the gate":"En la caseta"}</div>
                    <div class="v left">${lang==="en"
                      ? "Tell the security guard your name and the condo unit you reserved."
                      : "Dile al guardia tu nombre y la unidad que reservaste."
                    }</div>
                  </div>

                  <div style="display:flex; gap:10px; flex-wrap:wrap; margin-top:10px;">
                    <a class="chip primary" href="https://wa.me/${String(CONTENT.contacts.gate.whatsappE164).replace(/\D/g,'')}" target="_blank" rel="noopener">
                      üí¨ ${lang==="en"?"WhatsApp gate":"WhatsApp caseta"} ‚Üó
                    </a>
                  </div>
                </div>
              </details>

              <details id="checkin-notes">
                <summary>${lang==="en"?"Check-in notes":"Notas de llegada"} <span class="chev">‚åÑ</span></summary>
                <div class="detailsBody">
                  ${bullets(notes)}
                  <div style="display:flex; gap:10px; flex-wrap:wrap; margin-top:10px;">
                    <a class="chip primary" href="${(CONTENT.houseGuideVideos||[]).find(v=>v.id==="door")?.link || "#"}" target="_blank" rel="noopener">
                      üé¨ ${lang==="en"?"Watch door lock":"Ver cerradura"} ‚Üó
                    </a>
                  </div>
                </div>
              </details>

              <details id="transport">
                <summary>${lang==="en"?"Transportation from the airport":"Transporte desde el aeropuerto"} <span class="chev">‚åÑ</span></summary>
                <div class="detailsBody">
                  <p class="meta" style="margin:0 0 10px;">${lang==="en"
                    ? "For reliable transportation from the Canc√∫n airport, you can contact the property manager (Gerardo) or use a trusted transfer service."
                    : "Para transporte confiable desde el aeropuerto de Canc√∫n, puedes contactar al administrador (Gerardo) o usar un servicio de traslados."
                  }</p>

                  <div style="display:flex; gap:10px; flex-wrap:wrap;">
                    <a class="chip primary" href="https://usa-transfers.com/" target="_blank" rel="noopener">USA Transfers: ${lang==="en"?"Book":"Reservar"} ‚Üó</a>
                    <a class="chip primary" href="https://www.canadatransfers.com/" target="_blank" rel="noopener">Canada Transfers: ${lang==="en"?"Book":"Reservar"} ‚Üó</a>
                    <a class="chip" href="https://wa.me/${String(CONTENT.sos.propertyManagers[0].whatsappE164).replace(/\D/g,'')}" target="_blank" rel="noopener">üí¨ WhatsApp Gerardo ‚Üó</a>
                  </div>
                </div>
              </details>

              <details id="departure">
                <summary>${lang==="en"?"Departure (when it‚Äôs time)":"Salida (cuando llegue el momento)"} <span class="chev">‚åÑ</span></summary>
                <div class="detailsBody">
                  <p class="meta" style="margin:0 0 10px;">${lang==="en"
                    ? "You‚Äôll find the full check-out checklist under the Departure tile."
                    : "La lista completa de salida est√° en el bot√≥n de ‚ÄúSalida‚Äù."
                  }</p>
                  <button class="chip primary" type="button" data-jump="local" data-focus="checkout">${lang==="en"?"Go to Departure":"Ir a salida"}</button>
                </div>
              </details>
            </div>
          </section>
        `;

        pageEl.querySelectorAll("[data-jump]").forEach(el=>{
          el.addEventListener("click", ()=>{
            const target = el.getAttribute("data-jump");
            if(target) go(target, el.getAttribute("data-focus"));
          });
        });

        initAccordion(pageEl);
        setTimeout(scrollToFocusIfNeeded, 60);
        return;
      }

      if(page === "condo"){
        const vids = (CONTENT.houseGuideVideos || []).map((v,i)=>{
          const name = (lang==="en" ? v.titleEN : v.titleES);
          const sub  = (lang==="en" ? (v.subEN||"") : (v.subES||""));
          return linkCard(`${v.icon? v.icon+" " : ""}${name}`, v.link, I18N[lang].buttons.watch, i%2===1, sub, v.id || "");
        }).join("");

        pageEl.innerHTML = `
          <section class="card" id="condoTop">
            <h2 class="h2">üè† ${lang==="en"?"Condo":"Condo"}</h2>

            <div class="stack">
              <details id="wifi">
                <summary>üì∂ Wi-Fi <span class="chev">‚åÑ</span></summary>
                <div class="detailsBody">
                  <div class="kv">
                    <div class="k">${I18N[lang].labels.wifiNetwork}</div>
                    <div class="v left"><span class="mono">${CONTENT.wifi.name}</span></div>
                  </div>
                  <div class="kv coral" style="margin-top:10px;">
                    <div class="k">${I18N[lang].labels.wifiPassword}</div>
                    <div class="v left"><span class="mono">${CONTENT.wifi.pass}</span></div>
                  </div>

                  <div style="display:flex; gap:10px; flex-wrap:wrap; margin-top:10px;">
                    <button class="chip primary" type="button" id="copyWifiPass">${lang==="en"?"Copy password":"Copiar contrase√±a"}</button>
                    <button class="chip" type="button" id="copyWifiAll">${lang==="en"?"Copy network + pass":"Copiar red + contrase√±a"}</button>
                  </div>

                  <div class="qrWrap">
                    <img class="qr" src="qr.webp" alt="Wi-Fi QR code" loading="lazy" decoding="async" />
                    <p class="meta" style="margin:0;">${lang==="en"?"Scan to connect":"Escanea para conectarte"}</p>
                  </div>
                </div>
              </details>

              <details id="videos">
                <summary>üé¨ ${lang==="en"?"How-to videos":"Videos (c√≥mo usar)"} <span class="chev">‚åÑ</span></summary>
                <div class="detailsBody">
                  <div class="linkGrid">${vids}</div>
                </div>
              </details>

              <details id="rules">
                <summary>üìå ${lang==="en"?"House rules":"Reglas"} <span class="chev">‚åÑ</span></summary>
                <div class="detailsBody">
                  <details id="rules-parking">
                    <summary>${I18N[lang].sections.parking} <span class="chev">‚åÑ</span></summary>
                    <div class="detailsBody">${bullets(lang==="en"?CONTENT.rules.parkingEN:CONTENT.rules.parkingES)}</div>
                  </details>
                  <details id="rules-home">
                    <summary>${I18N[lang].sections.home} <span class="chev">‚åÑ</span></summary>
                    <div class="detailsBody">${bullets(lang==="en"?CONTENT.rules.homeEN:CONTENT.rules.homeES)}</div>
                  </details>
                  <details id="rules-pool">
                    <summary>${I18N[lang].sections.pool} <span class="chev">‚åÑ</span></summary>
                    <div class="detailsBody">${bullets(lang==="en"?CONTENT.rules.poolEN:CONTENT.rules.poolES)}</div>
                  </details>
                  <details id="rules-quiet">
                    <summary>${I18N[lang].sections.quiet} <span class="chev">‚åÑ</span></summary>
                    <div class="detailsBody">${bullets(lang==="en"?CONTENT.rules.quietEN:CONTENT.rules.quietES)}</div>
                  </details>
                </div>
              </details>

              <details id="sos">
                <summary>üÜò ${lang==="en"?"Help & contacts":"Ayuda y contactos"} <span class="chev">‚åÑ</span></summary>
                <div class="detailsBody">
                  <div class="linkGrid">
                    ${linkCard(`üí¨ ${CONTENT.sos.propertyManagers[0].name} (WhatsApp)`, `https://wa.me/${String(CONTENT.sos.propertyManagers[0].whatsappE164).replace(/\D/g,'')}`, "WhatsApp", false, (lang==="en"?"Property manager":"Administrador"))}
                    ${linkCard(`üí¨ ${CONTENT.sos.propertyManagers[1].name} (WhatsApp)`, `https://wa.me/${String(CONTENT.sos.propertyManagers[1].whatsappE164).replace(/\D/g,'')}`, "WhatsApp", true, (lang==="en"?"Property manager":"Administrador"))}
                    ${linkCard(`üí¨ ${CONTENT.sos.owner.name} (WhatsApp)`, `https://wa.me/${String(CONTENT.sos.owner.whatsappE164).replace(/\D/g,'')}`, "WhatsApp", false, (lang==="en"?"Owner / feedback":"Propietario / comentarios"))}
                  </div>

                  <div class="kv coral" style="margin-top:10px;">
                    <div class="k">${lang==="en"?"Emergency":"Emergencias"}</div>
                    <div class="v left">
                      <span class="mono">911</span>
                      <div style="margin-top:6px; font-size:12.5px; color: var(--muted);">
                        ${lang==="en" ? "Use only for real emergencies." : "√ösalo solo para emergencias reales."}
                      </div>
                    </div>
                  </div>
                </div>
              </details>
            </div>
          </section>
        `;

        document.getElementById("copyWifiPass")?.addEventListener("click", async ()=>{
          const ok = await copyText(CONTENT.wifi.pass);
          toast(ok ? I18N[lang].buttons.copied : (lang==="en"?"Copy failed":"No se pudo copiar"));
        });
        document.getElementById("copyWifiAll")?.addEventListener("click", async ()=>{
          const combo = `Wi-Fi: ${CONTENT.wifi.name}\nPassword: ${CONTENT.wifi.pass}`;
          const ok = await copyText(combo);
          toast(ok ? I18N[lang].buttons.copied : (lang==="en"?"Copy failed":"No se pudo copiar"));
        });

        initAccordion(pageEl);
        setTimeout(scrollToFocusIfNeeded, 60);
        return;
      }

      if(page === "local"){
        const addr = makeAddress();
        const makeCards = (arr) => (arr||[]).map((p,i)=> linkCard(p.name, p.link, I18N[lang].buttons.map, i%2===1)).join("");

        pageEl.innerHTML = `
          <section class="card">
            <h2 class="h2">üìç ${lang==="en"?"Local guide":"Gu√≠a local"}</h2>
            <p class="meta">${lang==="en"
              ? "Food, essentials, rentals, and activities‚Äîorganized for quick decisions."
              : "Comida, b√°sicos, rentas y actividades‚Äîorganizado para decidir r√°pido."
            }</p>

            <div class="stack">
              <details id="address">
                <summary>üó∫Ô∏è ${lang==="en"?"Address & map":"Direcci√≥n y mapa"} <span class="chev">‚åÑ</span></summary>
                <div class="detailsBody">
                  <div class="kv">
                    <div class="k">${I18N[lang].labels.address}</div>
                    <div class="v left"><span class="mono">${addr}</span></div>
                  </div>

                  <div style="display:flex; gap:10px; flex-wrap:wrap; margin-top:10px;">
                    <button class="chip primary" type="button" id="copyAddress">${lang==="en"?"Copy address":"Copiar direcci√≥n"}</button>
                    <a class="chip" href="${CONTENT.directions.mapLink}" target="_blank" rel="noopener">üó∫Ô∏è ${lang==="en"?"Open map":"Abrir mapa"} ‚Üó</a>
                  </div>

                  <p class="meta" style="margin-top:10px;">${lang==="en"
                    ? "If you rented a car, use the map link above and follow GPS directions to Selva Escondida. At the gate, show your reservation and ask to enter for the unit. Park only in the assigned spot for your apartment."
                    : "Si rentaste auto, usa el mapa y sigue el GPS a Selva Escondida. En la caseta, muestra tu reservaci√≥n y pide entrar para tu unidad. Estaciona solo en el lugar asignado."
                  }</p>
                </div>
              </details>

              <details id="shopping">
                <summary>üõí ${lang==="en"?"Shopping":"Compras"} <span class="chev">‚åÑ</span></summary>
                <div class="detailsBody">
                  <details id="supermarkets">
                    <summary>${I18N[lang].sections.supermarkets} <span class="chev">‚åÑ</span></summary>
                    <div class="detailsBody"><div class="linkGrid">${makeCards(CONTENT.shopping.supermarkets)}</div></div>
                  </details>
                  <details id="localGroceries">
                    <summary>${I18N[lang].sections.local} <span class="chev">‚åÑ</span></summary>
                    <div class="detailsBody"><div class="linkGrid">${makeCards(CONTENT.shopping.localGroceries)}</div></div>
                  </details>
                  <details id="fruit">
                    <summary>${I18N[lang].sections.fruit} <span class="chev">‚åÑ</span></summary>
                    <div class="detailsBody"><div class="linkGrid">${makeCards(CONTENT.shopping.fruitStands)}</div></div>
                  </details>
                </div>
              </details>

              <details id="food">
                <summary>üçΩÔ∏è ${lang==="en"?"Restaurants":"Restaurantes"} <span class="chev">‚åÑ</span></summary>
                <div class="detailsBody">
                  <details id="breakfast">
                    <summary>${I18N[lang].sections.breakfast} <span class="chev">‚åÑ</span></summary>
                    <div class="detailsBody"><div class="linkGrid">${makeCards(CONTENT.restaurants.breakfast)}</div></div>
                  </details>
                  <details id="seafood">
                    <summary>${I18N[lang].sections.seafood} <span class="chev">‚åÑ</span></summary>
                    <div class="detailsBody"><div class="linkGrid">${makeCards(CONTENT.restaurants.seafood)}</div></div>
                  </details>
                  <details id="dinner">
                    <summary>${I18N[lang].sections.dinner} <span class="chev">‚åÑ</span></summary>
                    <div class="detailsBody"><div class="linkGrid">${makeCards(CONTENT.restaurants.dinner)}</div></div>
                  </details>
                  <details id="pizza">
                    <summary>${I18N[lang].sections.pizza} <span class="chev">‚åÑ</span></summary>
                    <div class="detailsBody"><div class="linkGrid">${makeCards(CONTENT.restaurants.pizza)}</div></div>
                  </details>
                </div>
              </details>

              <details id="rentals">
                <summary>üöó ${lang==="en"?"Car & bike rentals":"Renta de auto y bici"} <span class="chev">‚åÑ</span></summary>
                <div class="detailsBody">
                  <div class="linkGrid">
                    ${linkCard(`üöó Luis (WhatsApp)`, `https://wa.me/${String(CONTENT.contacts.rentals.car.whatsappE164).replace(/\D/g,'')}`, "WhatsApp", false, (lang==="en"?"Car rental":"Renta de auto"))}
                    ${linkCard(`üö≤ Priscilla (WhatsApp)`, `https://wa.me/${String(CONTENT.contacts.rentals.bike.whatsappE164).replace(/\D/g,'')}`, "WhatsApp", true, (lang==="en"?"Bike rental":"Renta de bici"))}
                  </div>
                </div>
              </details>

              <details id="activities">
                <summary>‚ú® ${lang==="en"?"Activities":"Actividades"} <span class="chev">‚åÑ</span></summary>
                <div class="detailsBody">
                  <p class="meta" style="margin:0 0 10px;">${lang==="en"
                    ? "Book experiences through Localbird."
                    : "Reserva experiencias con Localbird."
                  }</p>

                  <div style="display:flex; gap:10px; flex-wrap:wrap;">
                    <a class="chip primary" href="${CONTENT.links.localbird}" target="_blank" rel="noopener">Localbird: ${lang==="en"?"Explore & book":"Ver y reservar"} ‚Üó</a>
                  </div>

                  <ul class="clean">
                    <li>${lang==="en"?"Snorkeling at the Puerto Morelos reef":"Snorkel en el arrecife de Puerto Morelos"}</li>
                    <li>${lang==="en"?"Cenotes day trip":"Excursi√≥n a cenotes"}</li>
                    <li>${lang==="en"?"Catamaran / beach day":"Catamar√°n / d√≠a de playa"}</li>
                    <li>${lang==="en"?"Chich√©n Itz√° or Tulum ruins":"Chich√©n Itz√° o Tulum"}</li>
                  </ul>
                </div>
              </details>

              <details id="checkout">
                <summary>‚úÖ ${lang==="en"?"Departure checklist":"Checklist de salida"} <span class="chev">‚åÑ</span></summary>
                <div class="detailsBody">
                  ${bullets((lang==="en") ? CONTENT.arrival.checkoutEN : CONTENT.arrival.checkoutES)}
                </div>
              </details>
            </div>
          </section>
        `;

        document.getElementById("copyAddress")?.addEventListener("click", async ()=>{
          const ok = await copyText(addr);
          toast(ok ? I18N[lang].buttons.copied : (lang==="en"?"Copy failed":"No se pudo copiar"));
        });

        initAccordion(pageEl);
        setTimeout(scrollToFocusIfNeeded, 60);
        return;
      }

      /* fallback */
      pageEl.innerHTML = `<section class="card"><h2 class="h2">‚Ä¶</h2><p class="meta">Page not found.</p></section>`;
      return;
    }

    function go(page, focusId){
      if(focusId) window.__focusId = focusId;
      render(page);
      window.scrollTo({top: 0, behavior: "smooth"});
      closeSheet(searchBackdrop);
      closeSheet(moreBackdrop);
    }

    const MORE_ITEMS = [
      { page:"home",   labelEN:"üèùÔ∏è Home",   labelES:"üèùÔ∏è Inicio",  hintEN:"Quick tiles", hintES:"Accesos r√°pidos" },
      { page:"arrival",labelEN:"üß≥ Arrival", labelES:"üß≥ Llegada", hintEN:"Gate + transport", hintES:"Caseta + transporte" },
      { page:"condo",  labelEN:"üè† Condo",  labelES:"üè† Condo",   hintEN:"Wi-Fi + videos + rules", hintES:"Wi-Fi + videos + reglas" },
      { page:"local",  labelEN:"üìç Local",  labelES:"üìç Local",   hintEN:"Food + shopping + rentals", hintES:"Comida + compras + rentas" }
    ];

    function buildMoreList(){
      moreList.innerHTML = MORE_ITEMS.map(it=>{
        const label = (lang==="en") ? it.labelEN : it.labelES;
        const hint  = (lang==="en") ? it.hintEN : it.hintES;
        return `
          <button class="miniBtn" type="button" data-go="${it.page}">
            <div>${label}<span>${hint}</span></div>
            <div class="rightMark">‚Üí</div>
          </button>
        `;
      }).join("");

      moreList.querySelectorAll("[data-go]").forEach(b=>{
        b.addEventListener("click", ()=> go(b.getAttribute("data-go")));
      });
    }

    function getSearchIndex(){
      const addr = makeAddress();
      return [
        { q: ["wifi","wi-fi","internet","contrase√±a","password","red"], label: "üì∂ Wi-Fi", hint: `${CONTENT.wifi.name} / ${CONTENT.wifi.pass}`, page:"condo", focus:"wifi" },
        { q: ["gate","caseta","security"], label: "üõ°Ô∏è " + (lang==="en"?"Main gate":"Caseta"), hint: (lang==="en"?"Tell guard your name + unit":"Da tu nombre + unidad"), page:"arrival", focus:"gate" },
        { q: ["transport","transfer","airport","aeropuerto"], label: "üõ¨ " + (lang==="en"?"Airport transportation":"Transporte aeropuerto"), hint: "USA / Canada Transfers", page:"arrival", focus:"transport" },
        { q: ["address","direccion","maps","mapa"], label: "üó∫Ô∏è " + (lang==="en"?"Address / map":"Direcci√≥n / mapa"), hint: addr, page:"local", focus:"address", copy: addr },
        { q: ["trash","basura","padlock","candado","combo","combinacion","3648"], label: "üöÆ " + (lang==="en"?"Trash combo":"Combinaci√≥n basura"), hint: "üîí 3648", page:"condo", focus:"videos", copy:"3648" },
        { q: ["safe","caja fuerte"], label: "üîê " + (lang==="en"?"Safe video":"Video caja fuerte"), hint: UNITS[unitKey].safeVideo, page:"condo", focus:"videos" },
        { q: ["checkout","check out","salida"], label: "‚úÖ " + (lang==="en"?"Departure checklist":"Checklist salida"), hint: CONTENT.arrival.checkoutTime, page:"local", focus:"checkout" },
      ];
    }

    function renderSearchResults(term){
      const t = term.trim().toLowerCase();
      const items = getSearchIndex();
      const filtered = !t ? items : items.filter(it=>{
        const hay = (it.q||[]).join(" ") + " " + (it.label||"") + " " + (it.hint||"");
        return hay.toLowerCase().includes(t);
      });

      searchResults.innerHTML = filtered.map(it=>{
        const tag = it.copy ? (lang==="en"?"Copy":"Copiar") : "‚Üí";
        const safeCopy = (it.copy||"").replace(/"/g,'&quot;');
        return `
          <button class="miniBtn" type="button"
            data-page="${it.page}"
            data-focus="${it.focus||""}"
            data-copy="${it.copy?1:0}"
            data-copytext="${safeCopy}">
            <div>${it.label}<span>${it.hint || ""}</span></div>
            <div class="rightMark">${tag}</div>
          </button>
        `;
      }).join("");

      searchResults.querySelectorAll(".miniBtn").forEach(btn=>{
        btn.addEventListener("click", async ()=>{
          const page = btn.getAttribute("data-page");
          const focus = btn.getAttribute("data-focus") || "";
          const wantsCopy = btn.getAttribute("data-copy") === "1";
          const copyTextValue = btn.getAttribute("data-copytext") || "";

          if(wantsCopy && copyTextValue){
            const ok = await copyText(copyTextValue);
            toast(ok ? I18N[lang].buttons.copied : (lang==="en"?"Copy failed":"No se pudo copiar"));
          }else{
            go(page, focus || null);
          }
        });
      });
    }

    navBtns.forEach(b=>{
      b.addEventListener("click", ()=> go(b.dataset.page));
    });

    unitToggle.addEventListener("click", ()=>{
      applyUnit(unitKey === "11c" ? "11d" : "11c");
      setChrome();
      render(currentPage);
      toast(lang==="en" ? `Switched to Unit ${UNITS[unitKey].label}` : `Cambiado a Unidad ${UNITS[unitKey].label}`);
    });

    langToggle.addEventListener("click", ()=>{
      lang = (lang==="en") ? "es" : "en";
      setChrome();
      render(currentPage);
      renderSearchResults(searchInput.value);
    });

    openSearchBtn.addEventListener("click", ()=>{
      openSheet(searchBackdrop);
      searchInput.value = "";
      renderSearchResults("");
    });
    closeSearchBtn.addEventListener("click", ()=> closeSheet(searchBackdrop));
    searchBackdrop.addEventListener("click", (e)=>{ if(e.target === searchBackdrop) closeSheet(searchBackdrop); });
    searchInput.addEventListener("input", ()=> renderSearchResults(searchInput.value));

    openMoreBtn.addEventListener("click", ()=> openSheet(moreBackdrop));
    closeMoreBtn.addEventListener("click", ()=> closeSheet(moreBackdrop));
    moreBackdrop.addEventListener("click", (e)=>{ if(e.target === moreBackdrop) closeSheet(moreBackdrop); });

    window.addEventListener("keydown", (e)=>{
      if(e.key === "Escape"){
        closeSheet(searchBackdrop);
        closeSheet(moreBackdrop);
      }
    });

    applyUnit(initUnitFromUrl());
    buildMoreList();
    setChrome();
    render("home");
  </script>
</body>
</html>
