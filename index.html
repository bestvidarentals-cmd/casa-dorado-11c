<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#fbf5ec" />
  <title>Casa Dorado 11C</title>

  <style>
    :root{
      /* Brand / beach */
      --sand:#fbf5ec;
      --foam:#ffffff;
      --ink:#172126;
      --muted:#4b5c62;

      --teal:#18a7a5;
      --turq:#2cc7c2;
      --coral:#ff6f61;

      --stroke:rgba(23,33,38,.12);
      --shadow:0 10px 22px rgba(13, 32, 32, .12);
      --shadow-soft:0 6px 14px rgba(13, 32, 32, .10);

      --r-xl:22px;
      --r-lg:18px;
      --r-md:14px;

      --s-1:4px;
      --s-2:8px;
      --s-3:12px;
      --s-4:16px;
      --s-5:24px;

      --tap:44px;

      /* layout */
      --maxw:520px;
      --navh:64px;
    }

    *{ box-sizing:border-box; }
    html, body{ height:100%; }
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      background: var(--sand);
      color: var(--ink);
    }

    /* Background */
    .bg{
      position: fixed;
      inset: 0;
      z-index: 0;
      background:
        linear-gradient(rgba(0,0,0,.35), rgba(0,0,0,.35)),
        url("bg-pool.jpg");
      background-size: cover;
      background-position: center;
      transform: scale(1.05);
    }
    @media (prefers-reduced-motion: no-preference){
      .bg{ animation: luxuryZoom 28s ease-in-out infinite alternate; will-change: transform; }
      @keyframes luxuryZoom{ from { transform: scale(1.05);} to { transform: scale(1.10);} }
    }
    @media (prefers-reduced-motion: reduce){
      .bg{ animation:none; }
    }

    /* App frame */
    .app{
      position:relative;
      z-index:1;
      max-width: var(--maxw);
      margin: 0 auto;
      padding: 12px 12px calc(var(--navh) + 16px);
    }

    .surface{
      background: rgba(255,255,255,.88);
      border: 1px solid var(--stroke);
      border-radius: 28px;
      box-shadow: var(--shadow);
      overflow:hidden;
      backdrop-filter: blur(6px);
    }

    /* Top bar */
    header{
      position: sticky;
      top: 0;
      z-index: 5;
      background:
        linear-gradient(180deg, rgba(44,199,194,.14), rgba(255,255,255,0) 70%),
        rgba(255,255,255,.92);
      border-bottom: 1px solid var(--stroke);
      backdrop-filter: blur(10px);
    }
    .topbar{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap: var(--s-3);
      padding: 14px 14px 10px;
    }
    .top-left{ min-width:0; }
    .title{
      margin:0;
      font-size: 18px;
      font-weight: 900;
      letter-spacing:.2px;
      line-height:1.15;
    }
    .subtitle{
      margin:6px 0 0;
      font-size: 13px;
      line-height:1.35;
      color: var(--muted);
    }

    .top-actions{
      display:flex;
      gap:8px;
      align-items:center;
      flex:0 0 auto;
    }

    button{
      font: inherit;
    }
    .chip{
      height: 38px;
      border-radius: 999px;
      padding: 0 12px;
      border:1px solid var(--stroke);
      background: var(--foam);
      color: var(--ink);
      font-weight: 850;
      font-size: 12.5px;
      cursor:pointer;
      box-shadow: var(--shadow-soft);
      -webkit-tap-highlight-color: transparent;
      user-select:none;
    }
    .chip:active{ transform: scale(.99); }
    .chip:focus-visible{
      outline: 3px solid rgba(24,167,165,.35);
      outline-offset: 2px;
    }
    .chip.primary{
      border-color: rgba(24,167,165,.35);
      background: rgba(44,199,194,.14);
    }
    .chip.coral{
      border-color: rgba(255,111,97,.45);
      background: rgba(255,111,97,.14);
    }

    main{
      padding: 14px;
    }

    /* Cards */
    .card{
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.92);
      border-radius: var(--r-xl);
      padding: 14px;
      box-shadow: var(--shadow-soft);
    }
    .stack{ display:flex; flex-direction:column; gap: 12px; }
    .h2{
      margin:0 0 8px;
      font-size: 16px;
      font-weight: 900;
      letter-spacing:.2px;
    }
    .meta{
      margin:0 0 10px;
      color: var(--muted);
      font-size: 13px;
      line-height:1.45;
    }

    /* Key/Value rows */
    .kv{
      display:flex;
      justify-content:space-between;
      align-items:flex-start;
      gap: 10px;
      padding: 10px 12px;
      border-radius: var(--r-lg);
      border: 1px solid rgba(24,167,165,.18);
      background: linear-gradient(180deg, rgba(44,199,194,.10), rgba(255,255,255,0));
      font-size: 13.5px;
    }
    .kv.coral{
      border: 1px solid rgba(255,111,97,.22);
      background: linear-gradient(180deg, rgba(255,111,97,.12), rgba(255,255,255,0));
    }
    .k{
      color: rgba(23,33,38,.72);
      font-weight: 900;
      min-width: 92px;
      flex:0 0 auto;
    }
    .v{
      text-align:right;
      font-weight: 650;
      flex: 1 1 auto;
    }
    .mono{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      letter-spacing:.2px;
    }
    .v.left{ text-align:left; }

    /* Quick actions */
    .actions{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-top: 10px;
    }
    .action{
      min-height: var(--tap);
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:flex-start;
      padding: 12px;
      border-radius: var(--r-xl);
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.92);
      box-shadow: var(--shadow-soft);
      text-decoration:none;
      color: var(--ink);
      -webkit-tap-highlight-color: transparent;
    }
    .action:active{ transform: scale(.99); }
    .action strong{
      display:block;
      font-size: 13.5px;
      font-weight: 900;
      line-height:1.1;
    }
    .action span{
      display:block;
      font-size: 12.5px;
      color: var(--muted);
      margin-top: 2px;
      line-height:1.2;
    }
    .badge{
      width: 40px;
      height: 40px;
      border-radius: 14px;
      display:grid;
      place-items:center;
      background: rgba(44,199,194,.14);
      border: 1px solid rgba(24,167,165,.22);
      flex: 0 0 auto;
      font-size: 18px;
    }
    .badge.coral{
      background: rgba(255,111,97,.14);
      border: 1px solid rgba(255,111,97,.22);
    }

    /* Link cards */
    .linkGrid{ display:flex; flex-direction:column; gap: 10px; }
    .linkCard{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
      padding: 14px;
      border-radius: var(--r-xl);
      border:1px solid var(--stroke);
      background: rgba(255,255,255,.92);
      text-decoration:none;
      color: var(--ink);
      box-shadow: var(--shadow-soft);
      -webkit-tap-highlight-color: transparent;
    }
    .linkCard:active{ transform: scale(.99); }
    .linkLeft{ min-width:0; }
    .linkTitle{
      font-weight: 900;
      font-size: 14px;
      letter-spacing:.2px;
      line-height: 1.15;
    }
    .linkSub{
      margin-top: 4px;
      font-size: 12.5px;
      color: var(--muted);
      line-height:1.25;
    }
    .linkPill{
      padding: 10px 12px;
      border-radius: 999px;
      font-weight: 900;
      font-size: 12px;
      border: 1px solid rgba(24,167,165,.35);
      background: rgba(44,199,194,.16);
      flex: 0 0 auto;
      white-space:nowrap;
    }
    .linkPill.coral{
      border: 1px solid rgba(255,111,97,.40);
      background: rgba(255,111,97,.16);
    }

    /* Accordions */
    details{
      border: 1px solid var(--stroke);
      border-radius: var(--r-xl);
      background: rgba(255,255,255,.92);
      box-shadow: var(--shadow-soft);
      overflow:hidden;
    }
    summary{
      list-style:none;
      cursor:pointer;
      padding: 14px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      min-height: var(--tap);
      -webkit-tap-highlight-color: transparent;
      font-weight: 900;
      font-size: 14px;
    }
    summary::-webkit-details-marker{ display:none; }
    .chev{
      width: 28px; height: 28px;
      border-radius: 12px;
      display:grid;
      place-items:center;
      border: 1px solid var(--stroke);
      background: rgba(44,199,194,.10);
      flex: 0 0 auto;
    }
    details[open] .chev{ transform: rotate(180deg); }
    .detailsBody{
      padding: 0 14px 14px;
      color: var(--ink);
      font-size: 13.5px;
      line-height:1.5;
    }
    ul.clean{ margin: 8px 0 0; padding-left: 18px; }
    ul.clean li{ margin: 6px 0; }

    /* Wi-Fi QR */
    .qrWrap{
      display:flex;
      flex-direction:column;
      align-items:center;
      gap: 8px;
      margin-top: 12px;
    }
    .qr{
      width: 180px;
      max-width: 100%;
      border-radius: var(--r-xl);
      box-shadow: var(--shadow-soft);
      border: 1px solid var(--stroke);
    }

    /* Bottom nav */
    .bottomNav{
      position: fixed;
      left: 0;
      right: 0;
      bottom: 0;
      z-index: 10;
      display:flex;
      justify-content:center;
      padding: 10px 12px 12px;
      pointer-events:none;
    }
    .navBar{
      pointer-events:auto;
      width: min(var(--maxw), calc(100% - 24px));
      background: rgba(255,255,255,.92);
      border: 1px solid var(--stroke);
      box-shadow: var(--shadow);
      border-radius: 22px;
      display:grid;
      grid-template-columns: repeat(5, 1fr);
      min-height: var(--navh);
      backdrop-filter: blur(10px);
      overflow:hidden;
    }
    .navBtn{
      border:0;
      background: transparent;
      padding: 8px 6px;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      gap: 4px;
      cursor:pointer;
      -webkit-tap-highlight-color: transparent;
      color: rgba(23,33,38,.70);
      font-weight: 850;
      font-size: 11px;
      min-height: var(--navh);
    }
    .navBtn .ico{ font-size: 18px; line-height:1; }
    .navBtn[aria-current="page"]{
      color: var(--ink);
      background: linear-gradient(180deg, rgba(44,199,194,.18), rgba(255,255,255,0));
    }
    .navBtn:focus-visible{
      outline: 3px solid rgba(24,167,165,.35);
      outline-offset: -3px;
    }

    /* Modal (Search + More) */
    .backdrop{
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,.40);
      z-index: 20;
      display:none;
      align-items:flex-end;
      justify-content:center;
      padding: 12px;
    }
    .backdrop.open{ display:flex; }
    .sheet{
      width: min(var(--maxw), 100%);
      background: rgba(255,255,255,.96);
      border: 1px solid var(--stroke);
      border-radius: 24px;
      box-shadow: var(--shadow);
      overflow:hidden;
      max-height: min(80dvh, 560px);
      display:flex;
      flex-direction:column;
    }
    .sheetHead{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 10px;
      padding: 12px 14px;
      border-bottom: 1px solid var(--stroke);
      background: linear-gradient(180deg, rgba(44,199,194,.12), rgba(255,255,255,0) 70%);
    }
    .sheetTitle{
      margin:0;
      font-size: 14px;
      font-weight: 900;
      letter-spacing:.2px;
    }
    .sheetBody{
      padding: 12px 14px 14px;
      overflow:auto;
      -webkit-overflow-scrolling: touch;
    }
    .field{
      display:flex;
      gap: 10px;
      align-items:center;
      border: 1px solid var(--stroke);
      background: #fff;
      border-radius: 16px;
      padding: 10px 12px;
      box-shadow: var(--shadow-soft);
    }
    .field input{
      border:0;
      outline:0;
      width:100%;
      font-size: 14px;
      background: transparent;
    }
    .hint{
      margin: 10px 0 0;
      font-size: 12.5px;
      color: var(--muted);
      line-height:1.35;
    }
    .list{
      margin-top: 12px;
      display:flex;
      flex-direction:column;
      gap: 10px;
    }
    .miniBtn{
      width:100%;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap: 12px;
      padding: 12px 14px;
      border-radius: 18px;
      border: 1px solid var(--stroke);
      background: rgba(255,255,255,.92);
      box-shadow: var(--shadow-soft);
      cursor:pointer;
      text-align:left;
      -webkit-tap-highlight-color: transparent;
      font-weight: 900;
      color: var(--ink);
    }
    .miniBtn span{
      display:block;
      font-weight: 700;
      color: var(--muted);
      font-size: 12.5px;
      margin-top: 2px;
    }
    .rightMark{
      flex: 0 0 auto;
      padding: 8px 10px;
      border-radius: 999px;
      border: 1px solid rgba(24,167,165,.35);
      background: rgba(44,199,194,.14);
      font-size: 12px;
      font-weight: 900;
      color: var(--ink);
    }
    .toast{
      position: fixed;
      left: 50%;
      transform: translateX(-50%);
      bottom: calc(var(--navh) + 18px);
      z-index: 30;
      background: rgba(23,33,38,.92);
      color: #fff;
      padding: 10px 12px;
      border-radius: 14px;
      font-size: 13px;
      display:none;
      box-shadow: var(--shadow);
      max-width: calc(100% - 24px);
      text-align:center;
    }
    .toast.show{ display:block; }

    /* Small phones */
    @media (max-width: 360px){
      .actions{ grid-template-columns: 1fr; }
    }
  </style>
</head>

<body>
  <div class="bg" aria-hidden="true"></div>

  <div class="app">
    <div class="surface" role="application" aria-label="Guest info hub">
      <header>
        <div class="topbar">
          <div class="top-left">
            <h1 class="title" id="propTitle"></h1>
            <p class="subtitle" id="propSubtitle"></p>
          </div>
          <div class="top-actions">
            <button class="chip primary" id="unitToggle" type="button" aria-label="Unit toggle"></button>
            <button class="chip" id="langToggle" type="button" aria-label="Language toggle"></button>
            <button class="chip coral" id="openSearch" type="button" aria-label="Search">üîé</button>
          </div>
        </div>
      </header>

      <main>
        <div id="page" class="stack"></div>
      </main>
    </div>
  </div>

  <!-- Bottom nav -->
  <div class="bottomNav" aria-hidden="false">
    <div class="navBar" role="navigation" aria-label="Primary">
      <button class="navBtn" data-page="home" aria-current="page" type="button"><div class="ico">üèùÔ∏è</div>Home</button>
      <button class="navBtn" data-page="directions" type="button"><div class="ico">üó∫Ô∏è</div>Map</button>
      <button class="navBtn" data-page="arrival" type="button"><div class="ico">üß≥</div>Arrival</button>
      <button class="navBtn" data-page="wifi" type="button"><div class="ico">üì∂</div>Wi-Fi</button>
      <button class="navBtn" id="openMore" type="button"><div class="ico">‚ûï</div>More</button>
    </div>
  </div>

  <!-- Search sheet -->
  <div class="backdrop" id="searchBackdrop" role="dialog" aria-modal="true" aria-label="Search">
    <div class="sheet" role="document">
      <div class="sheetHead">
        <p class="sheetTitle" id="searchTitle">Search</p>
        <button class="chip" id="closeSearch" type="button">‚úï</button>
      </div>
      <div class="sheetBody">
        <div class="field">
          <span aria-hidden="true">üîé</span>
          <input id="searchInput" type="search" placeholder="Search: Wi-Fi, trash, safe, checkout‚Ä¶" autocomplete="off" />
        </div>
        <p class="hint" id="searchHint"></p>
        <div class="list" id="searchResults"></div>
      </div>
    </div>
  </div>

  <!-- More sheet -->
  <div class="backdrop" id="moreBackdrop" role="dialog" aria-modal="true" aria-label="More menu">
    <div class="sheet" role="document">
      <div class="sheetHead">
        <p class="sheetTitle" id="moreTitle">More</p>
        <button class="chip" id="closeMore" type="button">‚úï</button>
      </div>
      <div class="sheetBody">
        <div class="list" id="moreList"></div>
      </div>
    </div>
  </div>

  <div class="toast" id="toast" role="status" aria-live="polite"></div>

  <script>
    /**********************************************************
     * EDIT ONLY THIS SECTION (CONTENT)
     **********************************************************/
    const CONTENT = {
      propertyName: "Casa Dorado 11C",

      wifi: { name: "DoradoGuest", pass: "b13nv3n1d0" },

      directions: {
        addressLine1: "CDA Las Nubes Edificio 11 Apt C",
        city: "Puerto Morelos",
        state: "Quintana Roo",
        zip: "77580",
        mapLink: "https://maps.app.goo.gl/Ufmdhn7Jatqre1Es5"
      },

      arrival: {
        checkinTime: "3:00 PM",
        checkoutTime: "11:00 AM",
        notesEN: [
          "Your personal door code will be sent privately before arrival.",
          "If you arrive early, you can drop luggage if the unit is ready.",
          "Please lock the door whenever you leave."
        ],
        notesES: [
          "Tu c√≥digo personal se enviar√° por privado antes de tu llegada.",
          "Si llegas temprano, puedes dejar maletas si la unidad ya est√° lista.",
          "Por favor cierra con llave cada vez que salgas."
        ],
        checkoutEN: [
          "Turn off A/C + lights",
          "Leave used towels in the bathroom",
          "Check for personal items",
          "Lock the door behind you"
        ],
        checkoutES: [
          "Apaga A/C y luces",
          "Deja toallas usadas en el ba√±o",
          "Revisa que no olvides pertenencias",
          "Cierra con llave al salir"
        ]
      },

      houseGuideVideos: [
        { icon:"üîí", titleEN:"Door Lock",              titleES:"Cerradura de la puerta",     link:"https://youtu.be/dZfc3S7i0bk" },
        { icon:"üö™", titleEN:"Open Patio Gate",        titleES:"Abrir la puerta del patio", link:"https://youtu.be/s7U20fFmzC0" },
        { icon:"üí°", titleEN:"Smart Lighting",         titleES:"Luces inteligentes",         link:"https://youtu.be/QDtUwEeHmGc" },
        { icon:"üì∫", titleEN:"Watch IPTV",             titleES:"Ver IPTV",                   link:"https://youtu.be/w78NTtRqdbI" },
        { icon:"‚ùÑÔ∏è", titleEN:"A/C Remote",             titleES:"Control del A/C",            link:"https://youtu.be/UFgrTn4xALA" },
        { icon:"üíß", titleEN:"Bottled Water",          titleES:"Agua embotellada",           link:"https://youtu.be/nwUs4Plp5dc" },
        { id:"trash", icon:"üöÆ", titleEN:"Trash", titleES:"Basura", link:"https://youtu.be/jsMapNBDmdw",
          subEN:"üîí Padlock combo: 3548", subES:"üîí Combinaci√≥n del candado: 3548" },
        { id:"safe", icon:"üîê", titleEN:"Wall Safe", titleES:"Caja fuerte", link:"https://youtu.be/DzP-1L-ezx8" }
      ],

      rules: {
        parkingEN: [
          "Only use the apartment‚Äôs assigned parking spot.",
          "Please do not use any other spaces."
        ],
        parkingES: [
          "Solo utiliza el caj√≥n de estacionamiento asignado.",
          "Por favor no uses otros cajones."
        ],
        homeEN: ["No smoking inside","No pets"],
        homeES: ["No fumar dentro","No mascotas"],
        poolEN: [
          "Pool hours: 8:00 AM ‚Äì 10:00 PM",
          "Shower before entering the pool",
          "You must have the FOB to access the pool"
        ],
        poolES: [
          "Horario de piscina: 8:00 AM ‚Äì 10:00 PM",
          "D√∫chate antes de entrar a la piscina",
          "Necesitas el FOB para acceso a la alberca"
        ],
        quietEN: ["Quiet hours: 10:00 PM ‚Äì 8:00 AM"],
        quietES: ["Horario de silencio: 10:00 PM ‚Äì 8:00 AM"]
      },

      shopping: {
        supermarkets: [
          { name: "S√∫per Ak√≠", link: "https://maps.app.goo.gl/mtMzpqGACHH7ACL16" },
          { name: "Chedraui", link: "https://maps.app.goo.gl/FRy6cjrsPJuGBxPx8" },
          { name: "Chedraui Selecto (nearby)", link: "https://www.google.com/maps/search/?api=1&query=Chedraui+Selecto+Puerto+Morelos+Quintana+Roo" }
        ],
        localGroceries: [
          { name: "OXXO (nearby)", link: "https://www.google.com/maps/search/?api=1&query=OXXO+Puerto+Morelos+Quintana+Roo" }
        ],
        fruitStands: [
          { name: "Fruit stand (Colonia side) #1", link: "https://www.google.com/maps/search/?api=1&query=fruteria+Colonia+Puerto+Morelos+Quintana+Roo" },
          { name: "Fruit stand (Colonia side) #2", link: "https://www.google.com/maps/search/?api=1&query=puesto+de+frutas+Colonia+Puerto+Morelos+Quintana+Roo" }
        ]
      },

      restaurants: {
        breakfast: [
          { name:"La Bodega Verde", link:"https://maps.app.goo.gl/JZapobhJJ3iQNjoH6" },
          { name:"El Nicho", link:"https://maps.app.goo.gl/qZNhAK6RA7MYN9Dg8" },
          { name:"Lola y Moya", link:"https://www.google.com/maps/search/?api=1&query=Lola+y+Moya+Puerto+Morelos" },
          { name:"Mangata", link:"https://www.google.com/maps/search/?api=1&query=Mangata+Puerto+Morelos" }
        ],
        seafood: [
          { name:"Los Koras", link:"https://www.google.com/maps/search/?api=1&query=Los+Koras+Puerto+Morelos" },
          { name:"La Playita", link:"https://www.google.com/maps/search/?api=1&query=La+Playita+Puerto+Morelos" },
          { name:"El Picudo", link:"https://www.google.com/maps/search/?api=1&query=El+Picudo+Puerto+Morelos" }
        ],
        dinner: [
          { name:"Punta Corcho", link:"https://www.google.com/maps/search/?api=1&query=Punta+Corcho+Puerto+Morelos" },
          { name:"La Sirena", link:"https://www.google.com/maps/search/?api=1&query=La+Sirena+Puerto+Morelos" },
          { name:"Miles Kitchen", link:"https://www.google.com/maps/search/?api=1&query=Miles+Kitchen+Puerto+Morelos" }
        ],
        pizza: [
          { name:"I Wanna Pizza", link:"https://www.google.com/maps/search/?api=1&query=I+Wanna+Pizza+Puerto+Morelos" },
          { name:"La Pizza Nostra", link:"https://www.google.com/maps/search/?api=1&query=La+Pizza+Nostra+Puerto+Morelos" },
          { name:"Oma Wood Oven Pizza", link:"https://www.google.com/maps/search/?api=1&query=Oma+Wood+Oven+Pizza+Puerto+Morelos" }
        ]
      },

      medical: {
        pharmacies: [
          { name: "Live Pharmacy", link: "https://maps.app.goo.gl/BwRW93Syr668yhXt7" },
          { name: "Farmacias Similares", link: "https://maps.app.goo.gl/xH5fbWHZ7GHYS38v8" }
        ]
      },

      sos: {
        authoritiesEN: [{ label: "Emergency (Mexico)", value: "911" }],
        authoritiesES: [{ label: "Emergencias (M√©xico)", value: "911" }],

        propertyManagers: [
          { name: "Gerardo Garcia", whatsappE164: "525587197202" },
          { name: "Abby Garcia", whatsappE164: "525529811958" }
        ],

        owner: { name: "Tony", whatsappE164: "13039751749" }
      }
    };

    // ---- Unit handling (11C / 11D) ----
    const UNITS = {
      "11c": {
        label: "11C",
        propertyName: "Casa Dorado 11C",
        safeVideo: "https://youtu.be/DzP-1L-ezx8"
      },
      "11d": {
        label: "11D",
        propertyName: "Casa Dorado 11D",
        safeVideo: "https://youtu.be/CS53-VqRZlE"
      }
    };

    let unitKey = "11c";

    function applyUnit(newKey){
      unitKey = (newKey === "11d") ? "11d" : "11c";
      const u = UNITS[unitKey];

      CONTENT.propertyName = u.propertyName;
      document.title = u.propertyName;

      const safeItem = (CONTENT.houseGuideVideos || []).find(v => v.id === "safe");
      if(safeItem) safeItem.link = u.safeVideo;

      const unitToggle = document.getElementById("unitToggle");
      if(unitToggle) unitToggle.textContent = u.label;

      const url = new URL(window.location.href);
      url.searchParams.set("unit", unitKey);
      window.history.replaceState({}, "", url.toString());
    }

    function initUnitFromUrl(){
      try{
        const url = new URL(window.location.href);
        const u = (url.searchParams.get("unit") || "").toLowerCase();
        if(u === "11d" || u === "d") return "11d";
      }catch(e){}
      return "11c";
    }

    /**********************************************************
     * APP (no need to edit below)
     **********************************************************/
    const I18N = {
      en: {
        subtitle: "Everything you need for a smooth stay‚Äîfast, simple, mobile-friendly.",
        searchTitle: "Search",
        searchHint: "Try: Wi-Fi, trash, safe, checkout, parking, pool‚Ä¶",
        moreTitle: "More",
        footerTip: "Tip: iPhone ‚Üí Share ‚Üí Add to Home Screen (feels like an app).",
        nav: { home:"Home", map:"Map", arrival:"Arrival", wifi:"Wi-Fi", more:"More" },
        buttons: { driving: "Driving Directions", copy: "Copy", copied: "Copied ‚úÖ", watch: "Watch", map: "Map", whatsapp: "WhatsApp" },
        labels: { address: "Address", checkin: "Check-in", checkout: "Check-out", wifiNetwork: "Network", wifiPassword: "Password" },
        sections: {
          quick: "Quick actions",
          common: "Most common",
          parking: "Parking", home: "Home", pool: "Pool", quiet: "Quiet Hours",
          supermarkets: "Supermarkets", local: "Local Grocery", fruit: "Fruit Stands",
          breakfast: "Breakfast / Coffee", seafood: "Seafood", dinner: "Dinner", pizza: "Pizza",
          pharmacies: "Pharmacies",
          authorities: "Authorities (Real Emergencies)", property: "Property Issues (Managers)", owner: "Owner / Feedback"
        }
      },
      es: {
        subtitle: "Todo lo esencial para tu estancia‚Äîr√°pido, simple y f√°cil en el celular.",
        searchTitle: "Buscar",
        searchHint: "Ejemplos: Wi-Fi, basura, caja fuerte, salida, estacionamiento‚Ä¶",
        moreTitle: "M√°s",
        footerTip: "Tip: iPhone ‚Üí Compartir ‚Üí Agregar a pantalla de inicio (se siente como app).",
        nav: { home:"Inicio", map:"Mapa", arrival:"Llegada", wifi:"Wi-Fi", more:"M√°s" },
        buttons: { driving: "C√≥mo llegar (Auto)", copy: "Copiar", copied: "Copiado ‚úÖ", watch: "Ver", map: "Mapa", whatsapp: "WhatsApp" },
        labels: { address: "Direcci√≥n", checkin: "Llegada", checkout: "Salida", wifiNetwork: "Red", wifiPassword: "Contrase√±a" },
        sections: {
          quick: "Acciones r√°pidas",
          common: "M√°s com√∫n",
          parking: "Estacionamiento", home: "Casa", pool: "Piscina", quiet: "Silencio",
          supermarkets: "Supermercados", local: "Tienda / OXXO", fruit: "Frutas (Colonia)",
          breakfast: "Desayuno / Caf√©", seafood: "Mariscos", dinner: "Cena", pizza: "Pizza",
          pharmacies: "Farmacias",
          authorities: "Autoridades (Emergencias reales)", property: "Problemas del depa (Administradores)", owner: "Propietario / Comentarios"
        }
      }
    };

    let lang = "en";
    let currentPage = "home";

    const pageEl = document.getElementById("page");
    const propTitle = document.getElementById("propTitle");
    const propSubtitle = document.getElementById("propSubtitle");
    const langToggle = document.getElementById("langToggle");
    const unitToggle = document.getElementById("unitToggle");
    const toastEl = document.getElementById("toast");

    // bottom nav
    const navBtns = [...document.querySelectorAll(".navBtn[data-page]")];
    const openMoreBtn = document.getElementById("openMore");

    // sheets
    const searchBackdrop = document.getElementById("searchBackdrop");
    const moreBackdrop = document.getElementById("moreBackdrop");
    const openSearchBtn = document.getElementById("openSearch");
    const closeSearchBtn = document.getElementById("closeSearch");
    const closeMoreBtn = document.getElementById("closeMore");
    const searchInput = document.getElementById("searchInput");
    const searchResults = document.getElementById("searchResults");
    const searchTitle = document.getElementById("searchTitle");
    const searchHint = document.getElementById("searchHint");
    const moreTitle = document.getElementById("moreTitle");
    const moreList = document.getElementById("moreList");

    function toast(msg){
      toastEl.textContent = msg;
      toastEl.classList.add("show");
      clearTimeout(toast._t);
      toast._t = setTimeout(()=> toastEl.classList.remove("show"), 1600);
    }

    function setChrome(){
      propTitle.textContent = CONTENT.propertyName;
      document.title = CONTENT.propertyName;
      propSubtitle.textContent = I18N[lang].subtitle;
      langToggle.textContent = (lang === "en") ? "ES" : "EN";
      document.documentElement.lang = lang;

      // bottom nav labels
      const labels = I18N[lang].nav;
      const mapBtn = document.querySelector('.navBtn[data-page="directions"]');
      const homeBtn = document.querySelector('.navBtn[data-page="home"]');
      const arrBtn = document.querySelector('.navBtn[data-page="arrival"]');
      const wifiBtn = document.querySelector('.navBtn[data-page="wifi"]');
      if(homeBtn) homeBtn.lastChild.nodeValue = labels.home;
      if(mapBtn) mapBtn.lastChild.nodeValue = labels.map;
      if(arrBtn) arrBtn.lastChild.nodeValue = labels.arrival;
      if(wifiBtn) wifiBtn.lastChild.nodeValue = labels.wifi;
      if(openMoreBtn) openMoreBtn.lastChild.nodeValue = labels.more;

      searchTitle.textContent = I18N[lang].searchTitle;
      searchHint.textContent = I18N[lang].searchHint;
      moreTitle.textContent = I18N[lang].moreTitle;

      // rebuild More list text when language changes
      buildMoreList();
    }

    function makeAddress(){
      const d = CONTENT.directions;
      return `${d.addressLine1}, ${d.city}, ${d.state} ${d.zip}`;
    }

    function kv(theme, k, v, mono=false, left=false){
      return `
        <div class="kv ${theme==='coral'?'coral':''}">
          <div class="k">${k}</div>
          <div class="v ${mono?'mono':''} ${left?'left':''}">${v}</div>
        </div>
      `;
    }

    function bullets(list){
      return `<ul class="clean">${(list||[]).map(x=>`<li>${x}</li>`).join("")}</ul>`;
    }

    function linkCard(title, link, pillText, coral=false, subText=""){
      return `
        <a class="linkCard" href="${link}" target="_blank" rel="noopener">
          <div class="linkLeft">
            <div class="linkTitle">${title}</div>
            ${subText ? `<div class="linkSub">${subText}</div>` : ""}
          </div>
          <div class="linkPill ${coral?'coral':''}">${pillText} ‚Üó</div>
        </a>
      `;
    }

    async function copyText(text){
      try{
        await navigator.clipboard.writeText(text);
        return true;
      }catch(e){
        // fallback
        try{
          const ta = document.createElement("textarea");
          ta.value = text;
          ta.setAttribute("readonly","");
          ta.style.position = "fixed";
          ta.style.left = "-9999px";
          document.body.appendChild(ta);
          ta.select();
          const ok = document.execCommand("copy");
          document.body.removeChild(ta);
          return ok;
        }catch{
          return false;
        }
      }
    }

    function setActiveNav(page){
      navBtns.forEach(b=>{
        const is = b.dataset.page === page;
        b.setAttribute("aria-current", is ? "page" : "false");
      });
    }

    // Pages
    function render(page){
      currentPage = page;
      setActiveNav(page);

      if(page === "home"){
        const t = (lang==="en") ? "Welcome" : "Bienvenidos";
        const commonTitle = I18N[lang].sections.common;

        const addr = makeAddress();
        const checkin = CONTENT.arrival.checkinTime;
        const checkout = CONTENT.arrival.checkoutTime;

        // quick actions
        const actions = `
          <div class="actions" role="list">
            <a class="action" href="${CONTENT.directions.mapLink}" target="_blank" rel="noopener" role="listitem">
              <div class="badge">üó∫Ô∏è</div>
              <div><strong>${lang==="en"?"Open Maps":"Abrir Maps"}</strong><span>${lang==="en"?"Driving directions":"C√≥mo llegar en auto"}</span></div>
            </a>

            <button class="action" type="button" role="listitem" data-jump="wifi">
              <div class="badge">üì∂</div>
              <div><strong>Wi-Fi</strong><span>${lang==="en"?"Network + password":"Red + contrase√±a"}</span></div>
            </button>

            <button class="action" type="button" role="listitem" data-jump="house" data-focus="trash">
              <div class="badge">üöÆ</div>
              <div><strong>${lang==="en"?"Trash":"Basura"}</strong><span>üîí 3548</span></div>
            </button>

            <button class="action" type="button" role="listitem" data-jump="sos">
              <div class="badge">üõ†Ô∏è</div>
              <div><strong>${lang==="en"?"Message managers":"WhatsApp admins"}</strong><span>${lang==="en"?"Fast help for condo issues":"Ayuda r√°pida"}</span></div>
            </button>
          </div>
        `;

        const commonVideos = (CONTENT.houseGuideVideos || []).filter(v => ["trash","safe"].includes(v.id) || /Door Lock/i.test(v.titleEN));
        const commonCards = commonVideos.map((v,i)=>{
          const name = (lang==="en" ? v.titleEN : v.titleES);
          const sub = (lang==="en" ? (v.subEN||"") : (v.subES||""));
          return linkCard(`${v.icon? v.icon+" " : ""}${name}`, v.link, I18N[lang].buttons.watch, i%2===1, sub);
        }).join("");

        pageEl.innerHTML = `
          <section class="card">
            <h2 class="h2">üèùÔ∏è ${t}</h2>
            <p class="meta">${lang==="en"
              ? "Use this page to find things fast (especially on your phone)."
              : "Usa esta p√°gina para encontrar todo r√°pido (especialmente en tu celular)."
            }</p>
            <div class="stack">
              ${kv("teal", I18N[lang].labels.checkin, checkin)}
              ${kv("teal", I18N[lang].labels.checkout, checkout)}
              <div class="kv coral">
                <div class="k">${I18N[lang].labels.address}</div>
                <div class="v left">${addr}</div>
              </div>

              <div>
                <div class="meta" style="margin:10px 0 8px; font-weight:900; color: rgba(23,33,38,.80);">${I18N[lang].sections.quick}</div>
                ${actions}
              </div>
            </div>
          </section>

          <section class="card">
            <h2 class="h2">‚ú® ${commonTitle}</h2>
            <p class="meta">${lang==="en" ? "The most-used items during stays." : "Lo m√°s usado durante la estancia."}</p>
            <div class="linkGrid">${commonCards}</div>

            <div style="display:flex; gap:10px; flex-wrap:wrap; margin-top:12px;">
              <button class="chip primary" type="button" data-jump="arrival">${lang==="en"?"Arrival & Checkout":"Llegada y salida"}</button>
              <button class="chip" type="button" data-jump="rules">${lang==="en"?"House rules":"Reglas"}</button>
              <button class="chip" type="button" data-jump="food">${lang==="en"?"Restaurants":"Restaurantes"}</button>
            </div>
          </section>

          <p class="meta" style="text-align:center; margin: 8px 0 0;">${I18N[lang].footerTip}</p>
        `;

        // wire jump buttons
        pageEl.querySelectorAll("[data-jump]").forEach(el=>{
          el.addEventListener("click", ()=>{
            const target = el.getAttribute("data-jump");
            if(target) go(target, el.getAttribute("data-focus"));
          });
        });

        return;
      }

      if(page === "directions"){
        const addr = makeAddress();
        pageEl.innerHTML = `
          <section class="card">
            <h2 class="h2">üó∫Ô∏è ${lang==="en"?"Directions":"C√≥mo llegar"}</h2>
            <p class="meta">${lang==="en"
              ? "Tap to open Google Maps. You can also copy the address."
              : "Toca para abrir Google Maps. Tambi√©n puedes copiar la direcci√≥n."
            }</p>
            <div class="stack">
              ${kv("teal", I18N[lang].labels.address, `<span class="mono">${addr}</span>`, false, true)}
              <div style="display:flex; gap:10px; flex-wrap:wrap; margin-top:6px;">
                <a class="chip primary" href="${CONTENT.directions.mapLink}" target="_blank" rel="noopener">${I18N[lang].buttons.driving} ‚Üó</a>
                <button class="chip" type="button" id="copyAddress">${I18N[lang].buttons.copy}</button>
              </div>
            </div>
          </section>
        `;
        const copyBtn = document.getElementById("copyAddress");
        copyBtn?.addEventListener("click", async ()=>{
          const ok = await copyText(addr);
          toast(ok ? I18N[lang].buttons.copied : (lang==="en"?"Copy failed":"No se pudo copiar"));
        });
        return;
      }

      if(page === "arrival"){
        const notes = (lang==="en") ? CONTENT.arrival.notesEN : CONTENT.arrival.notesES;
        const checklist = (lang==="en") ? CONTENT.arrival.checkoutEN : CONTENT.arrival.checkoutES;

        pageEl.innerHTML = `
          <section class="card">
            <h2 class="h2">üß≥ ${lang==="en"?"Arrival & Departure":"Llegada y salida"}</h2>
            <p class="meta">${lang==="en"
              ? "Everything in one place for a smooth check-in and check-out."
              : "Todo en un solo lugar para una llegada y salida sin complicaciones."
            }</p>

            <div class="stack">
              ${kv("teal", I18N[lang].labels.checkin, CONTENT.arrival.checkinTime)}
              ${kv("coral", I18N[lang].labels.checkout, CONTENT.arrival.checkoutTime)}
            </div>

            <div class="stack" style="margin-top:12px;">
              <details open>
                <summary>${lang==="en"?"Arrival notes":"Notas de llegada"} <span class="chev">‚åÑ</span></summary>
                <div class="detailsBody">${bullets(notes)}</div>
              </details>

              <details>
                <summary>${lang==="en"?"Check-out checklist":"Checklist de salida"} <span class="chev">‚åÑ</span></summary>
                <div class="detailsBody">${bullets(checklist)}</div>
              </details>
            </div>
          </section>
        `;
        return;
      }

      if(page === "wifi"){
        pageEl.innerHTML = `
          <section class="card">
            <h2 class="h2">üì∂ Wi-Fi</h2>
            <p class="meta">${lang==="en"
              ? "Use the info below or scan the QR code."
              : "Usa la informaci√≥n de abajo o escanea el c√≥digo QR."
            }</p>

            <div class="stack">
              ${kv("teal", I18N[lang].labels.wifiNetwork, `<span class="mono">${CONTENT.wifi.name}</span>`, false, true)}
              ${kv("coral", I18N[lang].labels.wifiPassword, `<span class="mono">${CONTENT.wifi.pass}</span>`, false, true)}
            </div>

            <div style="display:flex; gap:10px; flex-wrap:wrap; margin-top:12px;">
              <button class="chip primary" type="button" id="copyWifiPass">${lang==="en"?"Copy password":"Copiar contrase√±a"}</button>
              <button class="chip" type="button" id="copyWifiAll">${lang==="en"?"Copy network + pass":"Copiar red + contrase√±a"}</button>
            </div>

            <div class="qrWrap">
              <img class="qr" src="wifi-qr.jpg" alt="Wi-Fi QR Code" loading="lazy" decoding="async" />
              <p class="meta" style="margin:0;">${lang==="en"?"Scan to connect automatically":"Escanea para conectarte autom√°ticamente"}</p>
            </div>
          </section>
        `;

        document.getElementById("copyWifiPass")?.addEventListener("click", async ()=>{
          const ok = await copyText(CONTENT.wifi.pass);
          toast(ok ? I18N[lang].buttons.copied : (lang==="en"?"Copy failed":"No se pudo copiar"));
        });

        document.getElementById("copyWifiAll")?.addEventListener("click", async ()=>{
          const combo = `Wi-Fi: ${CONTENT.wifi.name}\nPassword: ${CONTENT.wifi.pass}`;
          const ok = await copyText(combo);
          toast(ok ? I18N[lang].buttons.copied : (lang==="en"?"Copy failed":"No se pudo copiar"));
        });
        return;
      }

      if(page === "house"){
        const title = (lang==="en" ? "Video House Guide" : "Gu√≠a en video");
        const desc  = (lang==="en" ? "Tap a video for quick how-tos." : "Toca un video para ver c√≥mo usar cosas de la casa.");

        const vids = (CONTENT.houseGuideVideos || []).map((v,i)=>{
          const name = (lang==="en" ? v.titleEN : v.titleES);
          const sub  = (lang==="en" ? (v.subEN||"") : (v.subES||""));
          return linkCard(`${v.icon? v.icon+" " : ""}${name}`, v.link, I18N[lang].buttons.watch, i%2===1, sub);
        }).join("");

        pageEl.innerHTML = `
          <section class="card" id="houseTop">
            <h2 class="h2">üé• ${title}</h2>
            <p class="meta">${desc}</p>
            <div class="linkGrid">${vids}</div>
          </section>
        `;

        // if we came here from a focused jump (trash, etc)
        if(window.__focusId){
          const target = (CONTENT.houseGuideVideos||[]).find(v=>v.id===window.__focusId);
          // just scroll top; link cards are in view
          setTimeout(()=> document.getElementById("houseTop")?.scrollIntoView({behavior:"smooth", block:"start"}), 50);
          window.__focusId = null;
        }
        return;
      }

      if(page === "rules"){
        const parking = bullets(lang==="en" ? CONTENT.rules.parkingEN : CONTENT.rules.parkingES);
        const home = bullets(lang==="en" ? CONTENT.rules.homeEN : CONTENT.rules.homeES);
        const pool = bullets(lang==="en" ? CONTENT.rules.poolEN : CONTENT.rules.poolES);
        const quiet = bullets(lang==="en" ? CONTENT.rules.quietEN : CONTENT.rules.quietES);

        pageEl.innerHTML = `
          <section class="card">
            <h2 class="h2">üìå ${lang==="en"?"House Rules":"Reglas de la casa"}</h2>
            <p class="meta">${lang==="en"
              ? "A few friendly rules to keep everyone comfortable."
              : "Unas reglas sencillas para que todos est√©n a gusto."
            }</p>

            <div class="stack">
              <details open>
                <summary>${I18N[lang].sections.parking} <span class="chev">‚åÑ</span></summary>
                <div class="detailsBody">${parking}</div>
              </details>
              <details>
                <summary>${I18N[lang].sections.home} <span class="chev">‚åÑ</span></summary>
                <div class="detailsBody">${home}</div>
              </details>
              <details>
                <summary>${I18N[lang].sections.pool} <span class="chev">‚åÑ</span></summary>
                <div class="detailsBody">${pool}</div>
              </details>
              <details>
                <summary>${I18N[lang].sections.quiet} <span class="chev">‚åÑ</span></summary>
                <div class="detailsBody">${quiet}</div>
              </details>
            </div>
          </section>
        `;
        return;
      }

      if(page === "shopping"){
        const makeCards = (arr) => (arr||[]).map((p,i)=> linkCard(p.name, p.link, (lang==="en"?"Map":"Mapa"), i%2===1)).join("");

        pageEl.innerHTML = `
          <section class="card">
            <h2 class="h2">üõí ${lang==="en"?"Shopping":"Compras"}</h2>
            <p class="meta">${lang==="en"?"Nearby places to buy food and essentials.":"Lugares cercanos para comprar comida y lo esencial."}</p>

            <details open>
              <summary>${I18N[lang].sections.supermarkets} <span class="chev">‚åÑ</span></summary>
              <div class="detailsBody"><div class="linkGrid">${makeCards(CONTENT.shopping.supermarkets)}</div></div>
            </details>

            <details>
              <summary>${I18N[lang].sections.local} <span class="chev">‚åÑ</span></summary>
              <div class="detailsBody"><div class="linkGrid">${makeCards(CONTENT.shopping.localGroceries)}</div></div>
            </details>

            <details>
              <summary>${I18N[lang].sections.fruit} <span class="chev">‚åÑ</span></summary>
              <div class="detailsBody"><div class="linkGrid">${makeCards(CONTENT.shopping.fruitStands)}</div></div>
            </details>
          </section>
        `;
        return;
      }

      if(page === "food"){
        const makeCards = (arr) => (arr||[]).map((p,i)=> linkCard(p.name, p.link, I18N[lang].buttons.map, i%2===1)).join("");

        pageEl.innerHTML = `
          <section class="card">
            <h2 class="h2">üçΩÔ∏è ${lang==="en"?"Restaurant Guide":"Gu√≠a de restaurantes"}</h2>
            <p class="meta">${lang==="en"
              ? "Top picks, organized for quick decisions."
              : "Recomendaciones organizadas para decidir r√°pido."
            }</p>

            <details open>
              <summary>${I18N[lang].sections.breakfast} <span class="chev">‚åÑ</span></summary>
              <div class="detailsBody"><div class="linkGrid">${makeCards(CONTENT.restaurants.breakfast)}</div></div>
            </details>

            <details>
              <summary>${I18N[lang].sections.seafood} <span class="chev">‚åÑ</span></summary>
              <div class="detailsBody"><div class="linkGrid">${makeCards(CONTENT.restaurants.seafood)}</div></div>
            </details>

            <details>
              <summary>${I18N[lang].sections.dinner} <span class="chev">‚åÑ</span></summary>
              <div class="detailsBody"><div class="linkGrid">${makeCards(CONTENT.restaurants.dinner)}</div></div>
            </details>

            <details>
              <summary>${I18N[lang].sections.pizza} <span class="chev">‚åÑ</span></summary>
              <div class="detailsBody"><div class="linkGrid">${makeCards(CONTENT.restaurants.pizza)}</div></div>
            </details>
          </section>
        `;
        return;
      }

      if(page === "medical"){
        const cards = (CONTENT.medical.pharmacies || []).map((p,i)=> linkCard(p.name, p.link, (lang==="en"?"Map":"Mapa"), i%2===1)).join("");
        pageEl.innerHTML = `
          <section class="card">
            <h2 class="h2">ü©∫ ${lang==="en"?"Medical Assistance":"Asistencia m√©dica"}</h2>
            <p class="meta">${lang==="en"?"Pharmacies and medical help.":"Farmacias y apoyo m√©dico."}</p>
            <div class="linkGrid">${cards}</div>
          </section>
        `;
        return;
      }

      if(page === "sos"){
        const auth = (lang==="en" ? CONTENT.sos.authoritiesEN : CONTENT.sos.authoritiesES);
        const authRows = (auth||[]).map((x,i)=> kv(i%2===1 ? "coral":"teal", x.label, `<span class="mono">${x.value}</span>`, false, true)).join("");

        const pmCards = (CONTENT.sos.propertyManagers || []).map((m,i)=>{
          const label = `${m.name} (WhatsApp)`;
          const url = `https://wa.me/${String(m.whatsappE164).replace(/\\D/g,'')}`;
          const sub = (lang==="en" ? "Repairs / condo issues" : "Reparaciones / problemas del depa");
          return linkCard(label, url, I18N[lang].buttons.whatsapp, i%2===1, sub);
        }).join("");

        const owner = CONTENT.sos.owner || {};
        const ownerUrl = `https://wa.me/${String(owner.whatsappE164).replace(/\\D/g,'')}`;
        const ownerSub = (lang==="en" ? "Owner questions / feedback" : "Preguntas / comentarios al propietario");
        const ownerCard = linkCard(`${owner.name} (WhatsApp)`, ownerUrl, I18N[lang].buttons.whatsapp, true, ownerSub);

        pageEl.innerHTML = `
          <section class="card">
            <h2 class="h2">üÜò ${lang==="en"?"SOS":"Ayuda"}</h2>
            <p class="meta">${lang==="en"
              ? "Pick the right contact for faster help."
              : "Elige el contacto correcto para recibir ayuda m√°s r√°pido."
            }</p>

            <details open>
              <summary>${I18N[lang].sections.authorities} <span class="chev">‚åÑ</span></summary>
              <div class="detailsBody">
                <div class="stack">${authRows}</div>
              </div>
            </details>

            <details>
              <summary>${I18N[lang].sections.property} <span class="chev">‚åÑ</span></summary>
              <div class="detailsBody"><div class="linkGrid">${pmCards}</div></div>
            </details>

            <details>
              <summary>${I18N[lang].sections.owner} <span class="chev">‚åÑ</span></summary>
              <div class="detailsBody"><div class="linkGrid">${ownerCard}</div></div>
            </details>
          </section>
        `;
        return;
      }
    }

    // Routing helper
    function go(page, focusId){
      if(focusId) window.__focusId = focusId;
      render(page);
      window.scrollTo({top: 0, behavior: "smooth"});
      // close sheets if open
      closeSheet(searchBackdrop);
      closeSheet(moreBackdrop);
    }

    // More menu
    const MORE_ITEMS = [
      { page:"house", labelEN:"üé• Videos", labelES:"üé• Videos", hintEN:"How-to guides", hintES:"Gu√≠as r√°pidas" },
      { page:"rules", labelEN:"üìå House rules", labelES:"üìå Reglas", hintEN:"Parking, pool, quiet hours", hintES:"Estacionamiento, piscina, silencio" },
      { page:"shopping", labelEN:"üõí Shopping", labelES:"üõí Compras", hintEN:"Groceries + essentials", hintES:"Super + b√°sicos" },
      { page:"food", labelEN:"üçΩÔ∏è Restaurants", labelES:"üçΩÔ∏è Restaurantes", hintEN:"Top picks", hintES:"Recomendados" },
      { page:"medical", labelEN:"ü©∫ Medical", labelES:"ü©∫ M√©dico", hintEN:"Pharmacies", hintES:"Farmacias" },
      { page:"sos", labelEN:"üÜò SOS", labelES:"üÜò Ayuda", hintEN:"Contacts + emergencies", hintES:"Contactos + emergencias" }
    ];

    function buildMoreList(){
      moreList.innerHTML = MORE_ITEMS.map(it=>{
        const label = (lang==="en") ? it.labelEN : it.labelES;
        const hint  = (lang==="en") ? it.hintEN : it.hintES;
        return `
          <button class="miniBtn" type="button" data-go="${it.page}">
            <div>${label}<span>${hint}</span></div>
            <div class="rightMark">‚Üí</div>
          </button>
        `;
      }).join("");

      moreList.querySelectorAll("[data-go]").forEach(b=>{
        b.addEventListener("click", ()=> go(b.getAttribute("data-go")));
      });
    }

    // Search index (simple + useful)
    function getSearchIndex(){
      const addr = makeAddress();
      const trash = (CONTENT.houseGuideVideos||[]).find(v=>v.id==="trash");
      const safe  = (CONTENT.houseGuideVideos||[]).find(v=>v.id==="safe");

      return [
        { q: ["wifi","wi-fi","internet","contrase√±a","password","red"], label: "üì∂ Wi-Fi", hint: `${CONTENT.wifi.name} / ${CONTENT.wifi.pass}`, page:"wifi" },
        { q: ["address","direccion","maps","mapa"], label: "üó∫Ô∏è " + (lang==="en"?"Address / Maps":"Direcci√≥n / Maps"), hint: addr, page:"directions", copy: addr },
        { q: ["trash","basura","padlock","candado","combo","combinacion","3548"], label: "üöÆ " + (lang==="en"?"Trash padlock combo":"Combinaci√≥n del candado"), hint: "üîí 3548", page:"house", copy:"3548", focus:"trash" },
        { q: ["safe","caja fuerte"], label: "üîê " + (lang==="en"?"Wall safe video":"Video caja fuerte"), hint: safe?.link || "", page:"house", focus:"safe" },
        { q: ["checkout","check out","salida","check-out","check out"], label: "üß≥ " + (lang==="en"?"Checkout checklist":"Checklist de salida"), hint: CONTENT.arrival.checkoutTime, page:"arrival" },
        { q: ["parking","estacionamiento"], label: "üÖøÔ∏è " + (lang==="en"?"Parking rules":"Reglas de estacionamiento"), hint: (lang==="en" ? CONTENT.rules.parkingEN[0] : CONTENT.rules.parkingES[0]), page:"rules" },
        { q: ["pool","piscina"], label: "üèä " + (lang==="en"?"Pool rules":"Reglas de la piscina"), hint: (lang==="en" ? CONTENT.rules.poolEN[0] : CONTENT.rules.poolES[0]), page:"rules" },
        { q: ["emergency","911","emergencia","ayuda","sos"], label: "üÜò " + (lang==="en"?"SOS / contacts":"Ayuda / contactos"), hint: "911", page:"sos" }
      ];
    }

    function renderSearchResults(term){
      const t = term.trim().toLowerCase();
      const items = getSearchIndex();

      const filtered = !t ? items : items.filter(it=>{
        const hay = (it.q||[]).join(" ") + " " + (it.label||"") + " " + (it.hint||"");
        return hay.toLowerCase().includes(t);
      });

      searchResults.innerHTML = filtered.map(it=>{
        const tag = it.copy ? (lang==="en"?"Copy":"Copiar") : "‚Üí";
        return `
          <button class="miniBtn" type="button" data-page="${it.page}" data-copy="${it.copy?1:0}" data-focus="${it.focus||""}" data-copytext="${(it.copy||"").replace(/"/g,'&quot;')}">
            <div>${it.label}<span>${it.hint || ""}</span></div>
            <div class="rightMark">${tag}</div>
          </button>
        `;
      }).join("");

      searchResults.querySelectorAll(".miniBtn").forEach(btn=>{
        btn.addEventListener("click", async ()=>{
          const page = btn.getAttribute("data-page");
          const focus = btn.getAttribute("data-focus") || "";
          const wantsCopy = btn.getAttribute("data-copy") === "1";
          const copyTextValue = btn.getAttribute("data-copytext") || "";

          if(wantsCopy && copyTextValue){
            const ok = await copyText(copyTextValue);
            toast(ok ? I18N[lang].buttons.copied : (lang==="en"?"Copy failed":"No se pudo copiar"));
          }else{
            go(page, focus || null);
          }
        });
      });
    }

    // Sheet helpers
    function openSheet(el){
      el.classList.add("open");
      // trap-ish: focus first input if search
      if(el === searchBackdrop){
        setTimeout(()=> searchInput.focus(), 50);
      }
    }
    function closeSheet(el){
      el.classList.remove("open");
    }

    // Events
    navBtns.forEach(b=>{
      b.addEventListener("click", ()=> go(b.dataset.page));
    });

    unitToggle.addEventListener("click", ()=>{
      applyUnit(unitKey === "11c" ? "11d" : "11c");
      setChrome();
      render(currentPage);
      toast(unitKey === "11c" ? "Unit 11C" : "Unit 11D");
    });

    langToggle.addEventListener("click", ()=>{
      lang = (lang==="en") ? "es" : "en";
      setChrome();
      render(currentPage);
      // update search UI language
      renderSearchResults(searchInput.value);
    });

    openSearchBtn.addEventListener("click", ()=>{
      openSheet(searchBackdrop);
      searchInput.value = "";
      renderSearchResults("");
    });
    closeSearchBtn.addEventListener("click", ()=> closeSheet(searchBackdrop));
    searchBackdrop.addEventListener("click", (e)=>{
      if(e.target === searchBackdrop) closeSheet(searchBackdrop);
    });
    searchInput.addEventListener("input", ()=> renderSearchResults(searchInput.value));

    openMoreBtn.addEventListener("click", ()=> openSheet(moreBackdrop));
    closeMoreBtn.addEventListener("click", ()=> closeSheet(moreBackdrop));
    moreBackdrop.addEventListener("click", (e)=>{
      if(e.target === moreBackdrop) closeSheet(moreBackdrop);
    });

    // ESC closes sheets
    window.addEventListener("keydown", (e)=>{
      if(e.key === "Escape"){
        closeSheet(searchBackdrop);
        closeSheet(moreBackdrop);
      }
    });

    // init
    applyUnit(initUnitFromUrl());
    buildMoreList();
    setChrome();
    render("home");
  </script>
</body>
</html>
